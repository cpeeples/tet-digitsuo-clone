<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DigitSuo Neural Network Digit Recognition: train.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DigitSuo Neural Network Digit Recognition<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Handwritten digit recognition system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('train_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">train.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;zlib.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for train.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c__incl.svg" width="531" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="train_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNetwork.html">Network</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTrainingResources.html">TrainingResources</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a889ec205c635b219999c761b28cc39ba" id="r_a889ec205c635b219999c761b28cc39ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a889ec205c635b219999c761b28cc39ba">omp_get_thread_num</a>()&#160;&#160;&#160;0</td></tr>
<tr class="separator:a889ec205c635b219999c761b28cc39ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e73060d1552ccda56039c7f3d25a84" id="r_a59e73060d1552ccda56039c7f3d25a84"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a59e73060d1552ccda56039c7f3d25a84">omp_get_max_threads</a>()&#160;&#160;&#160;1</td></tr>
<tr class="separator:a59e73060d1552ccda56039c7f3d25a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32ee58f73d9de0d1d41ad46f7bff2719" id="r_a32ee58f73d9de0d1d41ad46f7bff2719"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a32ee58f73d9de0d1d41ad46f7bff2719">RAND_SEED</a>&#160;&#160;&#160;42</td></tr>
<tr class="separator:a32ee58f73d9de0d1d41ad46f7bff2719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46567f67c294dd7d88edfc29f4a287f" id="r_aa46567f67c294dd7d88edfc29f4a287f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a>&#160;&#160;&#160;60000</td></tr>
<tr class="separator:aa46567f67c294dd7d88edfc29f4a287f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf254aa4a9118e049fea4bcf80c08761" id="r_aaf254aa4a9118e049fea4bcf80c08761"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>&#160;&#160;&#160;28</td></tr>
<tr class="separator:aaf254aa4a9118e049fea4bcf80c08761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc26a1aa65a6629bebea09a9744a05d4" id="r_adc26a1aa65a6629bebea09a9744a05d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a>&#160;&#160;&#160;13.5f</td></tr>
<tr class="separator:adc26a1aa65a6629bebea09a9744a05d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9593dc0614e0e38e3fb51cec2c8a214c" id="r_a9593dc0614e0e38e3fb51cec2c8a214c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a9593dc0614e0e38e3fb51cec2c8a214c">GAUSSIAN_SIGMA</a>&#160;&#160;&#160;0.3f</td></tr>
<tr class="separator:a9593dc0614e0e38e3fb51cec2c8a214c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf244dcd263840a02528b5710f9e239" id="r_aecf244dcd263840a02528b5710f9e239"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aecf244dcd263840a02528b5710f9e239">SHIFT_RANGE</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:aecf244dcd263840a02528b5710f9e239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc93837d219911cca065cecdb759afbf" id="r_abc93837d219911cca065cecdb759afbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#abc93837d219911cca065cecdb759afbf">SHIFT_OFFSET</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:abc93837d219911cca065cecdb759afbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0878932d6bed7392ae1d4e1b4d12bd1b" id="r_a0878932d6bed7392ae1d4e1b4d12bd1b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a0878932d6bed7392ae1d4e1b4d12bd1b">ROTATION_MAX_DEG</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a0878932d6bed7392ae1d4e1b4d12bd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ebf6899d6c1c8b7b9d09be872c05aae" id="r_a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>&#160;&#160;&#160;1e-10f</td></tr>
<tr class="separator:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515cb544d69e291ad8d0cf6813c23f93" id="r_a515cb544d69e291ad8d0cf6813c23f93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a515cb544d69e291ad8d0cf6813c23f93">PRINT_INTERVAL</a>&#160;&#160;&#160;50</td></tr>
<tr class="separator:a515cb544d69e291ad8d0cf6813c23f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4fb82063ff79b16c303ea9bc3fc7bfa" id="r_af4fb82063ff79b16c303ea9bc3fc7bfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#af4fb82063ff79b16c303ea9bc3fc7bfa">PATIENCE</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:af4fb82063ff79b16c303ea9bc3fc7bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a422c752554c1822f2a959d1f0e21da45" id="r_a422c752554c1822f2a959d1f0e21da45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a422c752554c1822f2a959d1f0e21da45">BASE_LR</a>&#160;&#160;&#160;0.1f</td></tr>
<tr class="separator:a422c752554c1822f2a959d1f0e21da45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71056dae36b9e620d0f517018e672d7" id="r_ac71056dae36b9e620d0f517018e672d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ac71056dae36b9e620d0f517018e672d7">LR_DECAY</a>&#160;&#160;&#160;0.95f</td></tr>
<tr class="separator:ac71056dae36b9e620d0f517018e672d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86cb6f507edc7b439a6fb895ab14cc1" id="r_ab86cb6f507edc7b439a6fb895ab14cc1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a>&#160;&#160;&#160;0.9f</td></tr>
<tr class="separator:ab86cb6f507edc7b439a6fb895ab14cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf72cd23bdafb47b19023d91b4c107d" id="r_abcf72cd23bdafb47b19023d91b4c107d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>&#160;&#160;&#160;784</td></tr>
<tr class="separator:abcf72cd23bdafb47b19023d91b4c107d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25246c9bd0d5ab0de866124c7fb55128" id="r_a25246c9bd0d5ab0de866124c7fb55128"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a25246c9bd0d5ab0de866124c7fb55128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894874fce4252e840e2412fd1dbfa4ea" id="r_a894874fce4252e840e2412fd1dbfa4ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a894874fce4252e840e2412fd1dbfa4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ae2958e436c566413867028fc829ec0" id="r_a9ae2958e436c566413867028fc829ec0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a9ae2958e436c566413867028fc829ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada2f6c75cc0154e34ea6a22ec4aeb665" id="r_ada2f6c75cc0154e34ea6a22ec4aeb665"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ada2f6c75cc0154e34ea6a22ec4aeb665">NUM_EPOCHS</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ada2f6c75cc0154e34ea6a22ec4aeb665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1801ad28fcbb4e352ad90a2e1c12a180" id="r_a1801ad28fcbb4e352ad90a2e1c12a180"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a1801ad28fcbb4e352ad90a2e1c12a180">SAMPLES_PER_DIGIT</a>&#160;&#160;&#160;1500</td></tr>
<tr class="separator:a1801ad28fcbb4e352ad90a2e1c12a180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ad142a4570cf177ac47f79fbf1680e2" id="r_a4ad142a4570cf177ac47f79fbf1680e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a4ad142a4570cf177ac47f79fbf1680e2">TOTAL_SAMPLES</a>&#160;&#160;&#160;(<a class="el" href="train_8c.html#a1801ad28fcbb4e352ad90a2e1c12a180">SAMPLES_PER_DIGIT</a> * <a class="el" href="weights_8h.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * 2)</td></tr>
<tr class="separator:a4ad142a4570cf177ac47f79fbf1680e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a45d123d4bb20d886e0c403b0245634b0" id="r_a45d123d4bb20d886e0c403b0245634b0"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a> (size_t size)</td></tr>
<tr class="separator:a45d123d4bb20d886e0c403b0245634b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045bb8b5750155f1b76ea8674ed46544" id="r_a045bb8b5750155f1b76ea8674ed46544"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a045bb8b5750155f1b76ea8674ed46544">initialize_network</a> (<a class="el" href="structNetwork.html">Network</a> *net)</td></tr>
<tr class="separator:a045bb8b5750155f1b76ea8674ed46544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbfc99bdf0d9b7f756aa9ed4f1902a9" id="r_a3fbfc99bdf0d9b7f756aa9ed4f1902a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a3fbfc99bdf0d9b7f756aa9ed4f1902a9">free_network</a> (<a class="el" href="structNetwork.html">Network</a> *net)</td></tr>
<tr class="separator:a3fbfc99bdf0d9b7f756aa9ed4f1902a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0867e81de2936adba1f10d470dd700a9" id="r_a0867e81de2936adba1f10d470dd700a9"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a0867e81de2936adba1f10d470dd700a9">random_normal</a> (void)</td></tr>
<tr class="separator:a0867e81de2936adba1f10d470dd700a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a02b98e2929bb19d76a6dfbbac24d14" id="r_a2a02b98e2929bb19d76a6dfbbac24d14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a2a02b98e2929bb19d76a6dfbbac24d14">read_idx_file</a> (const char *filename, unsigned char *data, int expected_size)</td></tr>
<tr class="separator:a2a02b98e2929bb19d76a6dfbbac24d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1e34018704a0309544d274d9af3520" id="r_a7a1e34018704a0309544d274d9af3520"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a7a1e34018704a0309544d274d9af3520">shuffle_data</a> (unsigned char *images, unsigned char *labels, int n)</td></tr>
<tr class="separator:a7a1e34018704a0309544d274d9af3520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691eb2f09a33f5f55506aa5cfbcba9de" id="r_a691eb2f09a33f5f55506aa5cfbcba9de"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a691eb2f09a33f5f55506aa5cfbcba9de">gaussian</a> (float x, float y, float sigma)</td></tr>
<tr class="separator:a691eb2f09a33f5f55506aa5cfbcba9de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed37ff204595e4f98c3038734cc8d349" id="r_aed37ff204595e4f98c3038734cc8d349"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aed37ff204595e4f98c3038734cc8d349">gaussian_filter</a> (float *input, float *output, int size, float sigma)</td></tr>
<tr class="separator:aed37ff204595e4f98c3038734cc8d349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fb9f512cf4afcefa5dce5e1608c9da" id="r_a72fb9f512cf4afcefa5dce5e1608c9da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a72fb9f512cf4afcefa5dce5e1608c9da">rotate_image</a> (unsigned char *input, unsigned char *output, float angle)</td></tr>
<tr class="separator:a72fb9f512cf4afcefa5dce5e1608c9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610d509260b461d3f463692149d97314" id="r_a610d509260b461d3f463692149d97314"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a610d509260b461d3f463692149d97314">augment_digit</a> (unsigned char *input, unsigned char *output)</td></tr>
<tr class="separator:a610d509260b461d3f463692149d97314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a540654dda30c1be810556dd42ed6c145" id="r_a540654dda30c1be810556dd42ed6c145"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a540654dda30c1be810556dd42ed6c145">create_augmented_dataset</a> (const unsigned char *train_images, const unsigned char *train_labels, unsigned char *augmented_images, unsigned char *augmented_labels)</td></tr>
<tr class="separator:a540654dda30c1be810556dd42ed6c145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6293450780c47c93c102da587f72ff" id="r_adb6293450780c47c93c102da587f72ff"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#adb6293450780c47c93c102da587f72ff">relu</a> (float x)</td></tr>
<tr class="separator:adb6293450780c47c93c102da587f72ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ac4bb5fc903348dece824ce5ddb25a" id="r_ac5ac4bb5fc903348dece824ce5ddb25a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ac5ac4bb5fc903348dece824ce5ddb25a">relu_derivative</a> (float x)</td></tr>
<tr class="separator:ac5ac4bb5fc903348dece824ce5ddb25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4131daa6fd8cbfd794235c891e3250" id="r_ada4131daa6fd8cbfd794235c891e3250"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ada4131daa6fd8cbfd794235c891e3250">softmax</a> (float *input, float *output, int size)</td></tr>
<tr class="separator:ada4131daa6fd8cbfd794235c891e3250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8ec7c8e288bad0b3243516a3b94ce82" id="r_af8ec7c8e288bad0b3243516a3b94ce82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#af8ec7c8e288bad0b3243516a3b94ce82">forward_pass</a> (const <a class="el" href="structNetwork.html">Network</a> *net, const float *batch_X, float *hidden_layer, float *output_layer)</td></tr>
<tr class="separator:af8ec7c8e288bad0b3243516a3b94ce82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2df9b11f3d149e3bb4d3410ca6808323" id="r_a2df9b11f3d149e3bb4d3410ca6808323"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a2df9b11f3d149e3bb4d3410ca6808323">compute_loss_accuracy</a> (const float *output_layer, const float *batch_y_onehot, const unsigned char *labels, int start_idx, float *batch_loss, float *batch_acc)</td></tr>
<tr class="separator:a2df9b11f3d149e3bb4d3410ca6808323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a062e67a2fff70756a17088d2582d8336" id="r_a062e67a2fff70756a17088d2582d8336"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a062e67a2fff70756a17088d2582d8336">backward_pass</a> (const <a class="el" href="structNetwork.html">Network</a> *net, const float *batch_X, const float *hidden_layer, const float *output_layer, const float *batch_y_onehot, float *hidden_error, float *output_error, float *dw_hidden, float *dw_output, float *db_hidden, float *db_output)</td></tr>
<tr class="separator:a062e67a2fff70756a17088d2582d8336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c77fb0483f3a735de5fb2ef3d74a0ff" id="r_a0c77fb0483f3a735de5fb2ef3d74a0ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a0c77fb0483f3a735de5fb2ef3d74a0ff">update_network</a> (<a class="el" href="structNetwork.html">Network</a> *net, const float *dw_hidden, const float *dw_output, const float *db_hidden, const float *db_output, float learning_rate)</td></tr>
<tr class="separator:a0c77fb0483f3a735de5fb2ef3d74a0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a437746e641f2bd51b37181f853986a82" id="r_a437746e641f2bd51b37181f853986a82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a437746e641f2bd51b37181f853986a82">save_weights</a> (<a class="el" href="structNetwork.html">Network</a> *net)</td></tr>
<tr class="separator:a437746e641f2bd51b37181f853986a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee0d81d2ae9aab7f0d911fea32858ab7" id="r_aee0d81d2ae9aab7f0d911fea32858ab7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aee0d81d2ae9aab7f0d911fea32858ab7">initialize_training_resources</a> (<a class="el" href="structTrainingResources.html">TrainingResources</a> *res)</td></tr>
<tr class="separator:aee0d81d2ae9aab7f0d911fea32858ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32ae2de2a05cfa448fe5f0032e439202" id="r_a32ae2de2a05cfa448fe5f0032e439202"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a32ae2de2a05cfa448fe5f0032e439202">free_training_resources</a> (<a class="el" href="structTrainingResources.html">TrainingResources</a> *res)</td></tr>
<tr class="separator:a32ae2de2a05cfa448fe5f0032e439202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad63ee2e58e4e87f600e8a35cb2b2a83e" id="r_ad63ee2e58e4e87f600e8a35cb2b2a83e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#ad63ee2e58e4e87f600e8a35cb2b2a83e">load_mnist_data</a> (unsigned char **train_images, unsigned char **train_labels)</td></tr>
<tr class="separator:ad63ee2e58e4e87f600e8a35cb2b2a83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45b379a1f8599ed7a63b03d911f5de2" id="r_af45b379a1f8599ed7a63b03d911f5de2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#af45b379a1f8599ed7a63b03d911f5de2">prepare_batch</a> (const unsigned char *images, const unsigned char *labels, int start_idx, float *batch_X, float *batch_y_onehot)</td></tr>
<tr class="separator:af45b379a1f8599ed7a63b03d911f5de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb2041f1a971bb8b5197c9dfd38c81f2" id="r_aeb2041f1a971bb8b5197c9dfd38c81f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#aeb2041f1a971bb8b5197c9dfd38c81f2">train_network</a> (<a class="el" href="structNetwork.html">Network</a> *net, unsigned char *aug_images, unsigned char *aug_labels, int total_samples, <a class="el" href="structTrainingResources.html">TrainingResources</a> *res)</td></tr>
<tr class="separator:aeb2041f1a971bb8b5197c9dfd38c81f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe" id="r_a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="train_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a422c752554c1822f2a959d1f0e21da45" name="a422c752554c1822f2a959d1f0e21da45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a422c752554c1822f2a959d1f0e21da45">&#9670;&#160;</a></span>BASE_LR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BASE_LR&#160;&#160;&#160;0.1f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00051">51</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a9ae2958e436c566413867028fc829ec0" name="a9ae2958e436c566413867028fc829ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ae2958e436c566413867028fc829ec0">&#9670;&#160;</a></span>BATCH_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BATCH_SIZE&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00058">58</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a6ebf6899d6c1c8b7b9d09be872c05aae" name="a6ebf6899d6c1c8b7b9d09be872c05aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebf6899d6c1c8b7b9d09be872c05aae">&#9670;&#160;</a></span>EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPS&#160;&#160;&#160;1e-10f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00048">48</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a9593dc0614e0e38e3fb51cec2c8a214c" name="a9593dc0614e0e38e3fb51cec2c8a214c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9593dc0614e0e38e3fb51cec2c8a214c">&#9670;&#160;</a></span>GAUSSIAN_SIGMA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GAUSSIAN_SIGMA&#160;&#160;&#160;0.3f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00044">44</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a25246c9bd0d5ab0de866124c7fb55128" name="a25246c9bd0d5ab0de866124c7fb55128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25246c9bd0d5ab0de866124c7fb55128">&#9670;&#160;</a></span>HIDDEN_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HIDDEN_SIZE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00056">56</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="adc26a1aa65a6629bebea09a9744a05d4" name="adc26a1aa65a6629bebea09a9744a05d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc26a1aa65a6629bebea09a9744a05d4">&#9670;&#160;</a></span>IMAGE_CENTER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_CENTER&#160;&#160;&#160;13.5f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00043">43</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="aaf254aa4a9118e049fea4bcf80c08761" name="aaf254aa4a9118e049fea4bcf80c08761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf254aa4a9118e049fea4bcf80c08761">&#9670;&#160;</a></span>IMAGE_DIM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMAGE_DIM&#160;&#160;&#160;28</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00042">42</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="abcf72cd23bdafb47b19023d91b4c107d" name="abcf72cd23bdafb47b19023d91b4c107d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcf72cd23bdafb47b19023d91b4c107d">&#9670;&#160;</a></span>INPUT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INPUT_SIZE&#160;&#160;&#160;784</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00055">55</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="ac71056dae36b9e620d0f517018e672d7" name="ac71056dae36b9e620d0f517018e672d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71056dae36b9e620d0f517018e672d7">&#9670;&#160;</a></span>LR_DECAY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LR_DECAY&#160;&#160;&#160;0.95f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00052">52</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="aa46567f67c294dd7d88edfc29f4a287f" name="aa46567f67c294dd7d88edfc29f4a287f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46567f67c294dd7d88edfc29f4a287f">&#9670;&#160;</a></span>MNIST_TRAIN_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MNIST_TRAIN_SIZE&#160;&#160;&#160;60000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00041">41</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="ab86cb6f507edc7b439a6fb895ab14cc1" name="ab86cb6f507edc7b439a6fb895ab14cc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab86cb6f507edc7b439a6fb895ab14cc1">&#9670;&#160;</a></span>MOMENTUM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOMENTUM&#160;&#160;&#160;0.9f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00053">53</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="ada2f6c75cc0154e34ea6a22ec4aeb665" name="ada2f6c75cc0154e34ea6a22ec4aeb665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada2f6c75cc0154e34ea6a22ec4aeb665">&#9670;&#160;</a></span>NUM_EPOCHS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_EPOCHS&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00059">59</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a59e73060d1552ccda56039c7f3d25a84" name="a59e73060d1552ccda56039c7f3d25a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e73060d1552ccda56039c7f3d25a84">&#9670;&#160;</a></span>omp_get_max_threads</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define omp_get_max_threads</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00037">37</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a889ec205c635b219999c761b28cc39ba" name="a889ec205c635b219999c761b28cc39ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a889ec205c635b219999c761b28cc39ba">&#9670;&#160;</a></span>omp_get_thread_num</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define omp_get_thread_num</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00036">36</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a894874fce4252e840e2412fd1dbfa4ea" name="a894874fce4252e840e2412fd1dbfa4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a894874fce4252e840e2412fd1dbfa4ea">&#9670;&#160;</a></span>OUTPUT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OUTPUT_SIZE&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00057">57</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="af4fb82063ff79b16c303ea9bc3fc7bfa" name="af4fb82063ff79b16c303ea9bc3fc7bfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4fb82063ff79b16c303ea9bc3fc7bfa">&#9670;&#160;</a></span>PATIENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PATIENCE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00050">50</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a515cb544d69e291ad8d0cf6813c23f93" name="a515cb544d69e291ad8d0cf6813c23f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a515cb544d69e291ad8d0cf6813c23f93">&#9670;&#160;</a></span>PRINT_INTERVAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRINT_INTERVAL&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00049">49</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a32ee58f73d9de0d1d41ad46f7bff2719" name="a32ee58f73d9de0d1d41ad46f7bff2719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32ee58f73d9de0d1d41ad46f7bff2719">&#9670;&#160;</a></span>RAND_SEED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAND_SEED&#160;&#160;&#160;42</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00040">40</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a0878932d6bed7392ae1d4e1b4d12bd1b" name="a0878932d6bed7392ae1d4e1b4d12bd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0878932d6bed7392ae1d4e1b4d12bd1b">&#9670;&#160;</a></span>ROTATION_MAX_DEG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROTATION_MAX_DEG&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00047">47</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a1801ad28fcbb4e352ad90a2e1c12a180" name="a1801ad28fcbb4e352ad90a2e1c12a180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1801ad28fcbb4e352ad90a2e1c12a180">&#9670;&#160;</a></span>SAMPLES_PER_DIGIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SAMPLES_PER_DIGIT&#160;&#160;&#160;1500</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00060">60</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="abc93837d219911cca065cecdb759afbf" name="abc93837d219911cca065cecdb759afbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc93837d219911cca065cecdb759afbf">&#9670;&#160;</a></span>SHIFT_OFFSET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHIFT_OFFSET&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00046">46</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="aecf244dcd263840a02528b5710f9e239" name="aecf244dcd263840a02528b5710f9e239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecf244dcd263840a02528b5710f9e239">&#9670;&#160;</a></span>SHIFT_RANGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHIFT_RANGE&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00045">45</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<a id="a4ad142a4570cf177ac47f79fbf1680e2" name="a4ad142a4570cf177ac47f79fbf1680e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ad142a4570cf177ac47f79fbf1680e2">&#9670;&#160;</a></span>TOTAL_SAMPLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOTAL_SAMPLES&#160;&#160;&#160;(<a class="el" href="train_8c.html#a1801ad28fcbb4e352ad90a2e1c12a180">SAMPLES_PER_DIGIT</a> * <a class="el" href="weights_8h.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00061">61</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a45d123d4bb20d886e0c403b0245634b0" name="a45d123d4bb20d886e0c403b0245634b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45d123d4bb20d886e0c403b0245634b0">&#9670;&#160;</a></span>allocate_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float * allocate_array </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00229">229</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>{</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">float</span> *array = (<span class="keywordtype">float</span> *)malloc(size * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> (!array)</div>
<div class="line"><span class="lineno">  233</span>    {</div>
<div class="line"><span class="lineno">  234</span>        fprintf(stderr, <span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  235</span>        exit(1);</div>
<div class="line"><span class="lineno">  236</span>    }</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">return</span> array;</div>
<div class="line"><span class="lineno">  238</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00252">initialize_network()</a>, and <a class="el" href="train_8c_source.html#l00116">initialize_training_resources()</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a45d123d4bb20d886e0c403b0245634b0_icgraph.svg" width="415" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a610d509260b461d3f463692149d97314" name="a610d509260b461d3f463692149d97314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610d509260b461d3f463692149d97314">&#9670;&#160;</a></span>augment_digit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void augment_digit </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00426">426</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  427</span>{</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *temp1 = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>);</div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *temp2 = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>);</div>
<div class="line"><span class="lineno">  430</span>    <span class="keywordtype">float</span> *float_buffer1 = (<span class="keywordtype">float</span> *)malloc(<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordtype">float</span> *float_buffer2 = (<span class="keywordtype">float</span> *)malloc(<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">if</span> (!temp1 || !temp2 || !float_buffer1 || !float_buffer2)</div>
<div class="line"><span class="lineno">  433</span>    {</div>
<div class="line"><span class="lineno">  434</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to allocate memory for augmentation\n&quot;</span>);</div>
<div class="line"><span class="lineno">  435</span>        exit(1);</div>
<div class="line"><span class="lineno">  436</span>    }</div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordtype">float</span> angle = ((float)rand() / RAND_MAX) * (2.0f * <a class="code hl_define" href="train_8c.html#a0878932d6bed7392ae1d4e1b4d12bd1b">ROTATION_MAX_DEG</a>) - <a class="code hl_define" href="train_8c.html#a0878932d6bed7392ae1d4e1b4d12bd1b">ROTATION_MAX_DEG</a>;</div>
<div class="line"><span class="lineno">  438</span>    <a class="code hl_function" href="train_8c.html#a72fb9f512cf4afcefa5dce5e1608c9da">rotate_image</a>(input, temp1, angle);</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordtype">int</span> shift_x = rand() % <a class="code hl_define" href="train_8c.html#aecf244dcd263840a02528b5710f9e239">SHIFT_RANGE</a> - <a class="code hl_define" href="train_8c.html#abc93837d219911cca065cecdb759afbf">SHIFT_OFFSET</a>;</div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordtype">int</span> shift_y = rand() % <a class="code hl_define" href="train_8c.html#aecf244dcd263840a02528b5710f9e239">SHIFT_RANGE</a> - <a class="code hl_define" href="train_8c.html#abc93837d219911cca065cecdb759afbf">SHIFT_OFFSET</a>;</div>
<div class="line"><span class="lineno">  441</span>    memset(temp2, 0, <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>);</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; y++)</div>
<div class="line"><span class="lineno">  443</span>    {</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; x++)</div>
<div class="line"><span class="lineno">  445</span>        {</div>
<div class="line"><span class="lineno">  446</span>            <span class="keywordtype">int</span> new_x = x + shift_x;</div>
<div class="line"><span class="lineno">  447</span>            <span class="keywordtype">int</span> new_y = y + shift_y;</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span> (new_x &gt;= 0 &amp;&amp; new_x &lt; IMAGE_DIM &amp;&amp; new_y &gt;= 0 &amp;&amp; new_y &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>)</div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                temp2[new_y * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + new_x] = temp1[y * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + x];</div>
<div class="line"><span class="lineno">  451</span>            }</div>
<div class="line"><span class="lineno">  452</span>        }</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; i++)</div>
<div class="line"><span class="lineno">  455</span>    {</div>
<div class="line"><span class="lineno">  456</span>        float_buffer1[i] = temp2[i] / 255.0f;</div>
<div class="line"><span class="lineno">  457</span>    }</div>
<div class="line"><span class="lineno">  458</span>    <a class="code hl_function" href="train_8c.html#aed37ff204595e4f98c3038734cc8d349">gaussian_filter</a>(float_buffer1, float_buffer2, <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>, <a class="code hl_define" href="train_8c.html#a9593dc0614e0e38e3fb51cec2c8a214c">GAUSSIAN_SIGMA</a>);</div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; i++)</div>
<div class="line"><span class="lineno">  460</span>    {</div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordtype">float</span> val = float_buffer2[i] * 255.0f;</div>
<div class="line"><span class="lineno">  462</span>        output[i] = (<span class="keywordtype">unsigned</span> char)((val &lt; 0) ? 0 : ((val &gt; 255) ? 255 : val));</div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span>    free(temp1);</div>
<div class="line"><span class="lineno">  465</span>    free(temp2);</div>
<div class="line"><span class="lineno">  466</span>    free(float_buffer1);</div>
<div class="line"><span class="lineno">  467</span>    free(float_buffer2);</div>
<div class="line"><span class="lineno">  468</span>}</div>
<div class="ttc" id="atrain_8c_html_a0878932d6bed7392ae1d4e1b4d12bd1b"><div class="ttname"><a href="train_8c.html#a0878932d6bed7392ae1d4e1b4d12bd1b">ROTATION_MAX_DEG</a></div><div class="ttdeci">#define ROTATION_MAX_DEG</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00047">train.c:47</a></div></div>
<div class="ttc" id="atrain_8c_html_a72fb9f512cf4afcefa5dce5e1608c9da"><div class="ttname"><a href="train_8c.html#a72fb9f512cf4afcefa5dce5e1608c9da">rotate_image</a></div><div class="ttdeci">void rotate_image(unsigned char *input, unsigned char *output, float angle)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00395">train.c:395</a></div></div>
<div class="ttc" id="atrain_8c_html_a9593dc0614e0e38e3fb51cec2c8a214c"><div class="ttname"><a href="train_8c.html#a9593dc0614e0e38e3fb51cec2c8a214c">GAUSSIAN_SIGMA</a></div><div class="ttdeci">#define GAUSSIAN_SIGMA</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00044">train.c:44</a></div></div>
<div class="ttc" id="atrain_8c_html_aaf254aa4a9118e049fea4bcf80c08761"><div class="ttname"><a href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a></div><div class="ttdeci">#define IMAGE_DIM</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00042">train.c:42</a></div></div>
<div class="ttc" id="atrain_8c_html_abc93837d219911cca065cecdb759afbf"><div class="ttname"><a href="train_8c.html#abc93837d219911cca065cecdb759afbf">SHIFT_OFFSET</a></div><div class="ttdeci">#define SHIFT_OFFSET</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00046">train.c:46</a></div></div>
<div class="ttc" id="atrain_8c_html_aecf244dcd263840a02528b5710f9e239"><div class="ttname"><a href="train_8c.html#aecf244dcd263840a02528b5710f9e239">SHIFT_RANGE</a></div><div class="ttdeci">#define SHIFT_RANGE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00045">train.c:45</a></div></div>
<div class="ttc" id="atrain_8c_html_aed37ff204595e4f98c3038734cc8d349"><div class="ttname"><a href="train_8c.html#aed37ff204595e4f98c3038734cc8d349">gaussian_filter</a></div><div class="ttdeci">void gaussian_filter(float *input, float *output, int size, float sigma)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00351">train.c:351</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00351">gaussian_filter()</a>, <a class="el" href="train_8c_source.html#l00044">GAUSSIAN_SIGMA</a>, <a class="el" href="train_8c_source.html#l00042">IMAGE_DIM</a>, <a class="el" href="train_8c_source.html#l00395">rotate_image()</a>, <a class="el" href="train_8c_source.html#l00047">ROTATION_MAX_DEG</a>, <a class="el" href="train_8c_source.html#l00046">SHIFT_OFFSET</a>, and <a class="el" href="train_8c_source.html#l00045">SHIFT_RANGE</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00470">create_augmented_dataset()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a610d509260b461d3f463692149d97314_cgraph.svg" width="420" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a610d509260b461d3f463692149d97314_icgraph.svg" width="478" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a062e67a2fff70756a17088d2582d8336" name="a062e67a2fff70756a17088d2582d8336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a062e67a2fff70756a17088d2582d8336">&#9670;&#160;</a></span>backward_pass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backward_pass </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>batch_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>hidden_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>output_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>batch_y_onehot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>hidden_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>dw_hidden</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>dw_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>db_hidden</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>db_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00608">608</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>{</div>
<div class="line"><span class="lineno">  612</span><span class="preprocessor">#pragma omp parallel sections</span></div>
<div class="line"><span class="lineno">  613</span>    {</div>
<div class="line"><span class="lineno">  614</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  615</span>        memset(dw_hidden, 0, <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  616</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  617</span>        memset(dw_output, 0, <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  618</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  619</span>        memset(db_hidden, 0, <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  620</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  621</span>        memset(db_output, 0, <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  622</span>    }</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span><span class="preprocessor">#pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  626</span>    {</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  628</span>        {</div>
<div class="line"><span class="lineno">  629</span>            output_error[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j] = output_layer[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j] - batch_y_onehot[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  630</span>        }</div>
<div class="line"><span class="lineno">  631</span>    }</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span><span class="preprocessor">#pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  635</span>    {</div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  637</span>        {</div>
<div class="line"><span class="lineno">  638</span>            <span class="keywordtype">float</span> sum_err = 0.0f;</div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  640</span>            {</div>
<div class="line"><span class="lineno">  641</span>                sum_err += output_error[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + k] * net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>[j * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + k];</div>
<div class="line"><span class="lineno">  642</span>            }</div>
<div class="line"><span class="lineno">  643</span>            hidden_error[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j] = sum_err * <a class="code hl_function" href="train_8c.html#ac5ac4bb5fc903348dece824ce5ddb25a">relu_derivative</a>(hidden_layer[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j]);</div>
<div class="line"><span class="lineno">  644</span>        }</div>
<div class="line"><span class="lineno">  645</span>    }</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="lineno">  648</span>    {</div>
<div class="line"><span class="lineno">  649</span><span class="preprocessor">#pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  651</span>        {</div>
<div class="line"><span class="lineno">  652</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  653</span>            {</div>
<div class="line"><span class="lineno">  654</span>                <span class="keywordtype">float</span> grad = 0.0f;</div>
<div class="line"><span class="lineno">  655</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  656</span>                {</div>
<div class="line"><span class="lineno">  657</span>                    grad += batch_X[i * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + j] * hidden_error[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + k];</div>
<div class="line"><span class="lineno">  658</span>                }</div>
<div class="line"><span class="lineno">  659</span>                dw_hidden[j * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + k] = grad / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  660</span>            }</div>
<div class="line"><span class="lineno">  661</span>        }</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span><span class="preprocessor">#pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  665</span>        {</div>
<div class="line"><span class="lineno">  666</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  667</span>            {</div>
<div class="line"><span class="lineno">  668</span>                <span class="keywordtype">float</span> grad = 0.0f;</div>
<div class="line"><span class="lineno">  669</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  670</span>                {</div>
<div class="line"><span class="lineno">  671</span>                    grad += hidden_layer[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j] * output_error[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + k];</div>
<div class="line"><span class="lineno">  672</span>                }</div>
<div class="line"><span class="lineno">  673</span>                dw_output[j * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + k] = grad / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  674</span>            }</div>
<div class="line"><span class="lineno">  675</span>        }</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span><span class="preprocessor">#pragma omp for</span></div>
<div class="line"><span class="lineno">  678</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  679</span>        {</div>
<div class="line"><span class="lineno">  680</span>            <span class="keywordtype">float</span> grad = 0.0f;</div>
<div class="line"><span class="lineno">  681</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  682</span>            {</div>
<div class="line"><span class="lineno">  683</span>                grad += hidden_error[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  684</span>            }</div>
<div class="line"><span class="lineno">  685</span>            db_hidden[j] = grad / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  686</span>        }</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span><span class="preprocessor">#pragma omp for</span></div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  690</span>        {</div>
<div class="line"><span class="lineno">  691</span>            <span class="keywordtype">float</span> grad = 0.0f;</div>
<div class="line"><span class="lineno">  692</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  693</span>            {</div>
<div class="line"><span class="lineno">  694</span>                grad += output_error[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  695</span>            }</div>
<div class="line"><span class="lineno">  696</span>            db_output[j] = grad / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  697</span>        }</div>
<div class="line"><span class="lineno">  698</span>    }</div>
<div class="line"><span class="lineno">  699</span>}</div>
<div class="ttc" id="astructNetwork_html_a7e455612362df041b021562ce934fe19"><div class="ttname"><a href="structNetwork.html#a7e455612362df041b021562ce934fe19">Network::output_weights</a></div><div class="ttdeci">float * output_weights</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00067">train.c:67</a></div></div>
<div class="ttc" id="atrain_8c_html_a25246c9bd0d5ab0de866124c7fb55128"><div class="ttname"><a href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a></div><div class="ttdeci">#define HIDDEN_SIZE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00056">train.c:56</a></div></div>
<div class="ttc" id="atrain_8c_html_a894874fce4252e840e2412fd1dbfa4ea"><div class="ttname"><a href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a></div><div class="ttdeci">#define OUTPUT_SIZE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00057">train.c:57</a></div></div>
<div class="ttc" id="atrain_8c_html_a9ae2958e436c566413867028fc829ec0"><div class="ttname"><a href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a></div><div class="ttdeci">#define BATCH_SIZE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00058">train.c:58</a></div></div>
<div class="ttc" id="atrain_8c_html_abcf72cd23bdafb47b19023d91b4c107d"><div class="ttname"><a href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a></div><div class="ttdeci">#define INPUT_SIZE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00055">train.c:55</a></div></div>
<div class="ttc" id="atrain_8c_html_ac5ac4bb5fc903348dece824ce5ddb25a"><div class="ttname"><a href="train_8c.html#ac5ac4bb5fc903348dece824ce5ddb25a">relu_derivative</a></div><div class="ttdeci">float relu_derivative(float x)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00517">train.c:517</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>, and <a class="el" href="train_8c_source.html#l00517">relu_derivative()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a062e67a2fff70756a17088d2582d8336_cgraph.svg" width="302" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a062e67a2fff70756a17088d2582d8336_icgraph.svg" width="396" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2df9b11f3d149e3bb4d3410ca6808323" name="a2df9b11f3d149e3bb4d3410ca6808323"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2df9b11f3d149e3bb4d3410ca6808323">&#9670;&#160;</a></span>compute_loss_accuracy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_loss_accuracy </td>
          <td>(</td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>output_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>batch_y_onehot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>batch_loss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>batch_acc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00575">575</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  577</span>{</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordtype">float</span> loss_val = 0.0f;</div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordtype">int</span> correct = 0;</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  581</span>    {</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordtype">float</span> single_loss = 0.0f;</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordtype">float</span> max_prob = output_layer[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>];</div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordtype">int</span> predicted = 0;</div>
<div class="line"><span class="lineno">  585</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  586</span>        {</div>
<div class="line"><span class="lineno">  587</span>            <span class="keywordtype">float</span> prob = output_layer[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordflow">if</span> (prob &gt; max_prob)</div>
<div class="line"><span class="lineno">  589</span>            {</div>
<div class="line"><span class="lineno">  590</span>                max_prob = prob;</div>
<div class="line"><span class="lineno">  591</span>                predicted = j;</div>
<div class="line"><span class="lineno">  592</span>            }</div>
<div class="line"><span class="lineno">  593</span>            <span class="keywordflow">if</span> (batch_y_onehot[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j] &gt; 0.5f)</div>
<div class="line"><span class="lineno">  594</span>            {</div>
<div class="line"><span class="lineno">  595</span>                single_loss -= logf(prob + <a class="code hl_define" href="train_8c.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>);</div>
<div class="line"><span class="lineno">  596</span>            }</div>
<div class="line"><span class="lineno">  597</span>        }</div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">if</span> (predicted == labels[start_idx + i])</div>
<div class="line"><span class="lineno">  599</span>        {</div>
<div class="line"><span class="lineno">  600</span>            correct++;</div>
<div class="line"><span class="lineno">  601</span>        }</div>
<div class="line"><span class="lineno">  602</span>        loss_val += single_loss;</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span>    *batch_loss = loss_val / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  605</span>    *batch_acc = (float)correct / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  606</span>}</div>
<div class="ttc" id="atrain_8c_html_a6ebf6899d6c1c8b7b9d09be872c05aae"><div class="ttname"><a href="train_8c.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a></div><div class="ttdeci">#define EPS</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00048">train.c:48</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00048">EPS</a>, and <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a2df9b11f3d149e3bb4d3410ca6808323_icgraph.svg" width="451" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a540654dda30c1be810556dd42ed6c145" name="a540654dda30c1be810556dd42ed6c145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a540654dda30c1be810556dd42ed6c145">&#9670;&#160;</a></span>create_augmented_dataset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_augmented_dataset </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>train_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>train_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>augmented_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>augmented_labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00470">470</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  472</span>{</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordtype">int</span> *digit_counts = (<span class="keywordtype">int</span> *)calloc(<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordtype">int</span> **digit_indices = (<span class="keywordtype">int</span> **)malloc(<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span> *));</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  476</span>    {</div>
<div class="line"><span class="lineno">  477</span>        digit_indices[i] = (<span class="keywordtype">int</span> *)malloc(<a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  478</span>        digit_counts[i] = 0;</div>
<div class="line"><span class="lineno">  479</span>    }</div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  481</span>    {</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordtype">int</span> digit = train_labels[i];</div>
<div class="line"><span class="lineno">  483</span>        digit_indices[digit][digit_counts[digit]++] = i;</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span>    <span class="keywordtype">int</span> sample_idx = 0;</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> digit = 0; digit &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; digit++)</div>
<div class="line"><span class="lineno">  487</span>    {</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a1801ad28fcbb4e352ad90a2e1c12a180">SAMPLES_PER_DIGIT</a>; j++)</div>
<div class="line"><span class="lineno">  489</span>        {</div>
<div class="line"><span class="lineno">  490</span>            <span class="keywordtype">int</span> remain = digit_counts[digit] - j;</div>
<div class="line"><span class="lineno">  491</span>            <span class="keywordtype">int</span> rand_idx = j + (rand() % remain);</div>
<div class="line"><span class="lineno">  492</span>            <span class="keywordtype">int</span> tmp_idx = digit_indices[digit][j];</div>
<div class="line"><span class="lineno">  493</span>            digit_indices[digit][j] = digit_indices[digit][rand_idx];</div>
<div class="line"><span class="lineno">  494</span>            digit_indices[digit][rand_idx] = tmp_idx;</div>
<div class="line"><span class="lineno">  495</span>            <span class="keywordtype">int</span> idx = digit_indices[digit][j];</div>
<div class="line"><span class="lineno">  496</span>            memcpy(&amp;augmented_images[sample_idx * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>], &amp;train_images[idx * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>], <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  497</span>            augmented_labels[sample_idx] = digit;</div>
<div class="line"><span class="lineno">  498</span>            sample_idx++;</div>
<div class="line"><span class="lineno">  499</span>            <a class="code hl_function" href="train_8c.html#a610d509260b461d3f463692149d97314">augment_digit</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;train_images[idx * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>], &amp;augmented_images[sample_idx * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>]);</div>
<div class="line"><span class="lineno">  500</span>            augmented_labels[sample_idx] = digit;</div>
<div class="line"><span class="lineno">  501</span>            sample_idx++;</div>
<div class="line"><span class="lineno">  502</span>        }</div>
<div class="line"><span class="lineno">  503</span>    }</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  505</span>    {</div>
<div class="line"><span class="lineno">  506</span>        free(digit_indices[i]);</div>
<div class="line"><span class="lineno">  507</span>    }</div>
<div class="line"><span class="lineno">  508</span>    free(digit_indices);</div>
<div class="line"><span class="lineno">  509</span>    free(digit_counts);</div>
<div class="line"><span class="lineno">  510</span>}</div>
<div class="ttc" id="atrain_8c_html_a1801ad28fcbb4e352ad90a2e1c12a180"><div class="ttname"><a href="train_8c.html#a1801ad28fcbb4e352ad90a2e1c12a180">SAMPLES_PER_DIGIT</a></div><div class="ttdeci">#define SAMPLES_PER_DIGIT</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00060">train.c:60</a></div></div>
<div class="ttc" id="atrain_8c_html_a610d509260b461d3f463692149d97314"><div class="ttname"><a href="train_8c.html#a610d509260b461d3f463692149d97314">augment_digit</a></div><div class="ttdeci">void augment_digit(unsigned char *input, unsigned char *output)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00426">train.c:426</a></div></div>
<div class="ttc" id="atrain_8c_html_aa46567f67c294dd7d88edfc29f4a287f"><div class="ttname"><a href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a></div><div class="ttdeci">#define MNIST_TRAIN_SIZE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00041">train.c:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00426">augment_digit()</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00041">MNIST_TRAIN_SIZE</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, and <a class="el" href="train_8c_source.html#l00060">SAMPLES_PER_DIGIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="train_8c_a540654dda30c1be810556dd42ed6c145_cgraph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a540654dda30c1be810556dd42ed6c145_icgraph.svg" width="314" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af8ec7c8e288bad0b3243516a3b94ce82" name="af8ec7c8e288bad0b3243516a3b94ce82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8ec7c8e288bad0b3243516a3b94ce82">&#9670;&#160;</a></span>forward_pass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forward_pass </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>batch_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>hidden_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output_layer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00542">542</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  543</span>{</div>
<div class="line"><span class="lineno">  544</span><span class="preprocessor">#pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  546</span>    {</div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  548</span>        {</div>
<div class="line"><span class="lineno">  549</span>            <span class="keywordtype">float</span> sum = net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a>[j];</div>
<div class="line"><span class="lineno">  550</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  551</span>            {</div>
<div class="line"><span class="lineno">  552</span>                sum += batch_X[i * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + k] * net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a>[k * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  553</span>            }</div>
<div class="line"><span class="lineno">  554</span>            hidden_layer[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + j] = <a class="code hl_function" href="train_8c.html#adb6293450780c47c93c102da587f72ff">relu</a>(sum);</div>
<div class="line"><span class="lineno">  555</span>        }</div>
<div class="line"><span class="lineno">  556</span>    }</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  560</span>    {</div>
<div class="line"><span class="lineno">  561</span>        <span class="keywordtype">float</span> tmp[<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>];</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  563</span>        {</div>
<div class="line"><span class="lineno">  564</span>            <span class="keywordtype">float</span> sum = net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a>[j];</div>
<div class="line"><span class="lineno">  565</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  566</span>            {</div>
<div class="line"><span class="lineno">  567</span>                sum += hidden_layer[i * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> + k] * net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>[k * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + j];</div>
<div class="line"><span class="lineno">  568</span>            }</div>
<div class="line"><span class="lineno">  569</span>            tmp[j] = sum;</div>
<div class="line"><span class="lineno">  570</span>        }</div>
<div class="line"><span class="lineno">  571</span>        <a class="code hl_function" href="train_8c.html#ada4131daa6fd8cbfd794235c891e3250">softmax</a>(tmp, &amp;output_layer[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>], <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span>}</div>
<div class="ttc" id="astructNetwork_html_a0eb4e771d57fa76646d94505d23b69c2"><div class="ttname"><a href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">Network::output_bias</a></div><div class="ttdeci">float * output_bias</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00068">train.c:68</a></div></div>
<div class="ttc" id="astructNetwork_html_a8cc052279886c1b01d6a0a1d047a0066"><div class="ttname"><a href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">Network::hidden_weights</a></div><div class="ttdeci">float * hidden_weights</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00065">train.c:65</a></div></div>
<div class="ttc" id="astructNetwork_html_aadc84bfd2c6e86ca02cee9a9b2b18fe1"><div class="ttname"><a href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">Network::hidden_bias</a></div><div class="ttdeci">float * hidden_bias</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00066">train.c:66</a></div></div>
<div class="ttc" id="atrain_8c_html_ada4131daa6fd8cbfd794235c891e3250"><div class="ttname"><a href="train_8c.html#ada4131daa6fd8cbfd794235c891e3250">softmax</a></div><div class="ttdeci">void softmax(float *input, float *output, int size)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00522">train.c:522</a></div></div>
<div class="ttc" id="atrain_8c_html_adb6293450780c47c93c102da587f72ff"><div class="ttname"><a href="train_8c.html#adb6293450780c47c93c102da587f72ff">relu</a></div><div class="ttdeci">float relu(float x)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00512">train.c:512</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00066">Network::hidden_bias</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00065">Network::hidden_weights</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00068">Network::output_bias</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>, <a class="el" href="train_8c_source.html#l00512">relu()</a>, and <a class="el" href="train_8c_source.html#l00522">softmax()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_af8ec7c8e288bad0b3243516a3b94ce82_cgraph.svg" width="243" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_af8ec7c8e288bad0b3243516a3b94ce82_icgraph.svg" width="383" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3fbfc99bdf0d9b7f756aa9ed4f1902a9" name="a3fbfc99bdf0d9b7f756aa9ed4f1902a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fbfc99bdf0d9b7f756aa9ed4f1902a9">&#9670;&#160;</a></span>free_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_network </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00240">240</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span>{</div>
<div class="line"><span class="lineno">  242</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a>);</div>
<div class="line"><span class="lineno">  243</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a>);</div>
<div class="line"><span class="lineno">  244</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>);</div>
<div class="line"><span class="lineno">  245</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a>);</div>
<div class="line"><span class="lineno">  246</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a>);</div>
<div class="line"><span class="lineno">  247</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a>);</div>
<div class="line"><span class="lineno">  248</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a>);</div>
<div class="line"><span class="lineno">  249</span>    free(net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a>);</div>
<div class="line"><span class="lineno">  250</span>}</div>
<div class="ttc" id="astructNetwork_html_a2224b842e1ac4f20ee957c9a36604c06"><div class="ttname"><a href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">Network::output_bias_momentum</a></div><div class="ttdeci">float * output_bias_momentum</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00072">train.c:72</a></div></div>
<div class="ttc" id="astructNetwork_html_a891f2791f142f8652bac3d5f9ea7399c"><div class="ttname"><a href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">Network::output_weights_momentum</a></div><div class="ttdeci">float * output_weights_momentum</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00071">train.c:71</a></div></div>
<div class="ttc" id="astructNetwork_html_a9921a0ae2aaa34ebf1090d49a9d64528"><div class="ttname"><a href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">Network::hidden_weights_momentum</a></div><div class="ttdeci">float * hidden_weights_momentum</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00069">train.c:69</a></div></div>
<div class="ttc" id="astructNetwork_html_ad06f80979b0f6fdbf8ee3b9e184f074c"><div class="ttname"><a href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">Network::hidden_bias_momentum</a></div><div class="ttdeci">float * hidden_bias_momentum</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00070">train.c:70</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00066">Network::hidden_bias</a>, <a class="el" href="train_8c_source.html#l00070">Network::hidden_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00065">Network::hidden_weights</a>, <a class="el" href="train_8c_source.html#l00069">Network::hidden_weights_momentum</a>, <a class="el" href="train_8c_source.html#l00068">Network::output_bias</a>, <a class="el" href="train_8c_source.html#l00072">Network::output_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>, and <a class="el" href="train_8c_source.html#l00071">Network::output_weights_momentum</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a3fbfc99bdf0d9b7f756aa9ed4f1902a9_icgraph.svg" width="222" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a32ae2de2a05cfa448fe5f0032e439202" name="a32ae2de2a05cfa448fe5f0032e439202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32ae2de2a05cfa448fe5f0032e439202">&#9670;&#160;</a></span>free_training_resources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_training_resources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTrainingResources.html">TrainingResources</a> *&#160;</td>
          <td class="paramname"><em>res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00130">130</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{</div>
<div class="line"><span class="lineno">  132</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">batch_X</a>);</div>
<div class="line"><span class="lineno">  133</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">batch_y_onehot</a>);</div>
<div class="line"><span class="lineno">  134</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ad507211c96dd96735112ce263156598f">hidden_layer</a>);</div>
<div class="line"><span class="lineno">  135</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">output_layer</a>);</div>
<div class="line"><span class="lineno">  136</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac23532e125a919f78d4649badc9ccaf0">hidden_error</a>);</div>
<div class="line"><span class="lineno">  137</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#acd7837e924805f9f5884c5691085f26a">output_error</a>);</div>
<div class="line"><span class="lineno">  138</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a06d35c239aaba97abcc22958fd167158">dw_hidden</a>);</div>
<div class="line"><span class="lineno">  139</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a748cd804c7b1a215005f47359c153a06">dw_output</a>);</div>
<div class="line"><span class="lineno">  140</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac36967338cce6cf90bce99a367eb2827">db_hidden</a>);</div>
<div class="line"><span class="lineno">  141</span>    free(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#aad9e00ff690e8fcbe8fb7ab33f4a95e7">db_output</a>);</div>
<div class="line"><span class="lineno">  142</span>}</div>
<div class="ttc" id="astructTrainingResources_html_a06d35c239aaba97abcc22958fd167158"><div class="ttname"><a href="structTrainingResources.html#a06d35c239aaba97abcc22958fd167158">TrainingResources::dw_hidden</a></div><div class="ttdeci">float * dw_hidden</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00083">train.c:83</a></div></div>
<div class="ttc" id="astructTrainingResources_html_a1f8cbac853cda8f2da2c603252063a21"><div class="ttname"><a href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">TrainingResources::output_layer</a></div><div class="ttdeci">float * output_layer</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00080">train.c:80</a></div></div>
<div class="ttc" id="astructTrainingResources_html_a748cd804c7b1a215005f47359c153a06"><div class="ttname"><a href="structTrainingResources.html#a748cd804c7b1a215005f47359c153a06">TrainingResources::dw_output</a></div><div class="ttdeci">float * dw_output</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00084">train.c:84</a></div></div>
<div class="ttc" id="astructTrainingResources_html_aad9e00ff690e8fcbe8fb7ab33f4a95e7"><div class="ttname"><a href="structTrainingResources.html#aad9e00ff690e8fcbe8fb7ab33f4a95e7">TrainingResources::db_output</a></div><div class="ttdeci">float * db_output</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00086">train.c:86</a></div></div>
<div class="ttc" id="astructTrainingResources_html_ab3d3425c79868eac1c2f85317957cdb1"><div class="ttname"><a href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">TrainingResources::batch_y_onehot</a></div><div class="ttdeci">float * batch_y_onehot</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00078">train.c:78</a></div></div>
<div class="ttc" id="astructTrainingResources_html_ac23532e125a919f78d4649badc9ccaf0"><div class="ttname"><a href="structTrainingResources.html#ac23532e125a919f78d4649badc9ccaf0">TrainingResources::hidden_error</a></div><div class="ttdeci">float * hidden_error</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00081">train.c:81</a></div></div>
<div class="ttc" id="astructTrainingResources_html_ac36967338cce6cf90bce99a367eb2827"><div class="ttname"><a href="structTrainingResources.html#ac36967338cce6cf90bce99a367eb2827">TrainingResources::db_hidden</a></div><div class="ttdeci">float * db_hidden</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00085">train.c:85</a></div></div>
<div class="ttc" id="astructTrainingResources_html_acd7837e924805f9f5884c5691085f26a"><div class="ttname"><a href="structTrainingResources.html#acd7837e924805f9f5884c5691085f26a">TrainingResources::output_error</a></div><div class="ttdeci">float * output_error</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00082">train.c:82</a></div></div>
<div class="ttc" id="astructTrainingResources_html_ad507211c96dd96735112ce263156598f"><div class="ttname"><a href="structTrainingResources.html#ad507211c96dd96735112ce263156598f">TrainingResources::hidden_layer</a></div><div class="ttdeci">float * hidden_layer</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00079">train.c:79</a></div></div>
<div class="ttc" id="astructTrainingResources_html_ae5f2baecab3da2a330a81e58240d1197"><div class="ttname"><a href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">TrainingResources::batch_X</a></div><div class="ttdeci">float * batch_X</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00077">train.c:77</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00077">TrainingResources::batch_X</a>, <a class="el" href="train_8c_source.html#l00078">TrainingResources::batch_y_onehot</a>, <a class="el" href="train_8c_source.html#l00085">TrainingResources::db_hidden</a>, <a class="el" href="train_8c_source.html#l00086">TrainingResources::db_output</a>, <a class="el" href="train_8c_source.html#l00083">TrainingResources::dw_hidden</a>, <a class="el" href="train_8c_source.html#l00084">TrainingResources::dw_output</a>, <a class="el" href="train_8c_source.html#l00081">TrainingResources::hidden_error</a>, <a class="el" href="train_8c_source.html#l00079">TrainingResources::hidden_layer</a>, <a class="el" href="train_8c_source.html#l00082">TrainingResources::output_error</a>, and <a class="el" href="train_8c_source.html#l00080">TrainingResources::output_layer</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a32ae2de2a05cfa448fe5f0032e439202_icgraph.svg" width="288" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a691eb2f09a33f5f55506aa5cfbcba9de" name="a691eb2f09a33f5f55506aa5cfbcba9de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691eb2f09a33f5f55506aa5cfbcba9de">&#9670;&#160;</a></span>gaussian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float gaussian </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00344">344</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  345</span>{</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordtype">float</span> coeff = 1.0f / (2.0f * M_PI * sigma * sigma);</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordtype">float</span> expo = -(x * x + y * y) / (2.0f * sigma * sigma);</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">return</span> coeff * expf(expo);</div>
<div class="line"><span class="lineno">  349</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00351">gaussian_filter()</a>.</p>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="train_8c_a691eb2f09a33f5f55506aa5cfbcba9de_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aed37ff204595e4f98c3038734cc8d349" name="aed37ff204595e4f98c3038734cc8d349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed37ff204595e4f98c3038734cc8d349">&#9670;&#160;</a></span>gaussian_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gaussian_filter </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00351">351</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>{</div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordtype">int</span> kernel_size = (int)(6.0f * sigma);</div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">if</span> (kernel_size % 2 == 0)</div>
<div class="line"><span class="lineno">  355</span>        kernel_size++;</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordtype">int</span> half = kernel_size / 2;</div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordtype">float</span> *kernel = (<span class="keywordtype">float</span> *)malloc(kernel_size * kernel_size * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordtype">float</span> sum = 0.0f;</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = -half; y &lt;= half; y++)</div>
<div class="line"><span class="lineno">  360</span>    {</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = -half; x &lt;= half; x++)</div>
<div class="line"><span class="lineno">  362</span>        {</div>
<div class="line"><span class="lineno">  363</span>            <span class="keywordtype">float</span> g = <a class="code hl_function" href="train_8c.html#a691eb2f09a33f5f55506aa5cfbcba9de">gaussian</a>((<span class="keywordtype">float</span>)x, (<span class="keywordtype">float</span>)y, sigma);</div>
<div class="line"><span class="lineno">  364</span>            kernel[(y + half) * kernel_size + (x + half)] = g;</div>
<div class="line"><span class="lineno">  365</span>            sum += g;</div>
<div class="line"><span class="lineno">  366</span>        }</div>
<div class="line"><span class="lineno">  367</span>    }</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kernel_size * kernel_size; i++)</div>
<div class="line"><span class="lineno">  369</span>    {</div>
<div class="line"><span class="lineno">  370</span>        kernel[i] /= sum;</div>
<div class="line"><span class="lineno">  371</span>    }</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; size; y++)</div>
<div class="line"><span class="lineno">  373</span>    {</div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; size; x++)</div>
<div class="line"><span class="lineno">  375</span>        {</div>
<div class="line"><span class="lineno">  376</span>            <span class="keywordtype">float</span> val = 0.0f;</div>
<div class="line"><span class="lineno">  377</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ky = -half; ky &lt;= half; ky++)</div>
<div class="line"><span class="lineno">  378</span>            {</div>
<div class="line"><span class="lineno">  379</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kx = -half; kx &lt;= half; kx++)</div>
<div class="line"><span class="lineno">  380</span>                {</div>
<div class="line"><span class="lineno">  381</span>                    <span class="keywordtype">int</span> py = y + ky;</div>
<div class="line"><span class="lineno">  382</span>                    <span class="keywordtype">int</span> px = x + kx;</div>
<div class="line"><span class="lineno">  383</span>                    <span class="keywordflow">if</span> (px &gt;= 0 &amp;&amp; px &lt; size &amp;&amp; py &gt;= 0 &amp;&amp; py &lt; size)</div>
<div class="line"><span class="lineno">  384</span>                    {</div>
<div class="line"><span class="lineno">  385</span>                        val += input[py * size + px] * kernel[(ky + half) * kernel_size + (kx + half)];</div>
<div class="line"><span class="lineno">  386</span>                    }</div>
<div class="line"><span class="lineno">  387</span>                }</div>
<div class="line"><span class="lineno">  388</span>            }</div>
<div class="line"><span class="lineno">  389</span>            output[y * size + x] = val;</div>
<div class="line"><span class="lineno">  390</span>        }</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span>    free(kernel);</div>
<div class="line"><span class="lineno">  393</span>}</div>
<div class="ttc" id="atrain_8c_html_a691eb2f09a33f5f55506aa5cfbcba9de"><div class="ttname"><a href="train_8c.html#a691eb2f09a33f5f55506aa5cfbcba9de">gaussian</a></div><div class="ttdeci">float gaussian(float x, float y, float sigma)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00344">train.c:344</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00344">gaussian()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00426">augment_digit()</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aed37ff204595e4f98c3038734cc8d349_cgraph.svg" width="256" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aed37ff204595e4f98c3038734cc8d349_icgraph.svg" width="643" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a045bb8b5750155f1b76ea8674ed46544" name="a045bb8b5750155f1b76ea8674ed46544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045bb8b5750155f1b76ea8674ed46544">&#9670;&#160;</a></span>initialize_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_network </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00252">252</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>{</div>
<div class="line"><span class="lineno">  254</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  255</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  256</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  257</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  258</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  259</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  260</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  261</span>    net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordtype">float</span> scale = sqrtf(2.0f / <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  263</span>    srand(<a class="code hl_define" href="train_8c.html#a32ee58f73d9de0d1d41ad46f7bff2719">RAND_SEED</a>);</div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>        net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a>[i] = <a class="code hl_function" href="train_8c.html#a0867e81de2936adba1f10d470dd700a9">random_normal</a>() * scale;</div>
<div class="line"><span class="lineno">  267</span>        net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a>[i] = 0.0f;</div>
<div class="line"><span class="lineno">  268</span>    }</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  270</span>    {</div>
<div class="line"><span class="lineno">  271</span>        net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>[i] = <a class="code hl_function" href="train_8c.html#a0867e81de2936adba1f10d470dd700a9">random_normal</a>() * scale;</div>
<div class="line"><span class="lineno">  272</span>        net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a>[i] = 0.0f;</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span>    memset(net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a>, 0, <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  275</span>    memset(net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a>, 0, <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  276</span>    memset(net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a>, 0, <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  277</span>    memset(net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a>, 0, <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  278</span>}</div>
<div class="ttc" id="atrain_8c_html_a0867e81de2936adba1f10d470dd700a9"><div class="ttname"><a href="train_8c.html#a0867e81de2936adba1f10d470dd700a9">random_normal</a></div><div class="ttdeci">float random_normal(void)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00280">train.c:280</a></div></div>
<div class="ttc" id="atrain_8c_html_a32ee58f73d9de0d1d41ad46f7bff2719"><div class="ttname"><a href="train_8c.html#a32ee58f73d9de0d1d41ad46f7bff2719">RAND_SEED</a></div><div class="ttdeci">#define RAND_SEED</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00040">train.c:40</a></div></div>
<div class="ttc" id="atrain_8c_html_a45d123d4bb20d886e0c403b0245634b0"><div class="ttname"><a href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a></div><div class="ttdeci">float * allocate_array(size_t size)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00229">train.c:229</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00229">allocate_array()</a>, <a class="el" href="train_8c_source.html#l00066">Network::hidden_bias</a>, <a class="el" href="train_8c_source.html#l00070">Network::hidden_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00065">Network::hidden_weights</a>, <a class="el" href="train_8c_source.html#l00069">Network::hidden_weights_momentum</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00068">Network::output_bias</a>, <a class="el" href="train_8c_source.html#l00072">Network::output_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>, <a class="el" href="train_8c_source.html#l00071">Network::output_weights_momentum</a>, <a class="el" href="train_8c_source.html#l00040">RAND_SEED</a>, and <a class="el" href="train_8c_source.html#l00280">random_normal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a045bb8b5750155f1b76ea8674ed46544_cgraph.svg" width="323" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a045bb8b5750155f1b76ea8674ed46544_icgraph.svg" width="252" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aee0d81d2ae9aab7f0d911fea32858ab7" name="aee0d81d2ae9aab7f0d911fea32858ab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee0d81d2ae9aab7f0d911fea32858ab7">&#9670;&#160;</a></span>initialize_training_resources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_training_resources </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTrainingResources.html">TrainingResources</a> *&#160;</td>
          <td class="paramname"><em>res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00116">116</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">batch_X</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  119</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">batch_y_onehot</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  120</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ad507211c96dd96735112ce263156598f">hidden_layer</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  121</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">output_layer</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  122</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac23532e125a919f78d4649badc9ccaf0">hidden_error</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  123</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#acd7837e924805f9f5884c5691085f26a">output_error</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  124</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a06d35c239aaba97abcc22958fd167158">dw_hidden</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  125</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a748cd804c7b1a215005f47359c153a06">dw_output</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  126</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac36967338cce6cf90bce99a367eb2827">db_hidden</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  127</span>    res-&gt;<a class="code hl_variable" href="structTrainingResources.html#aad9e00ff690e8fcbe8fb7ab33f4a95e7">db_output</a> = <a class="code hl_function" href="train_8c.html#a45d123d4bb20d886e0c403b0245634b0">allocate_array</a>(<a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  128</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00229">allocate_array()</a>, <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00077">TrainingResources::batch_X</a>, <a class="el" href="train_8c_source.html#l00078">TrainingResources::batch_y_onehot</a>, <a class="el" href="train_8c_source.html#l00085">TrainingResources::db_hidden</a>, <a class="el" href="train_8c_source.html#l00086">TrainingResources::db_output</a>, <a class="el" href="train_8c_source.html#l00083">TrainingResources::dw_hidden</a>, <a class="el" href="train_8c_source.html#l00084">TrainingResources::dw_output</a>, <a class="el" href="train_8c_source.html#l00081">TrainingResources::hidden_error</a>, <a class="el" href="train_8c_source.html#l00079">TrainingResources::hidden_layer</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00082">TrainingResources::output_error</a>, <a class="el" href="train_8c_source.html#l00080">TrainingResources::output_layer</a>, and <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aee0d81d2ae9aab7f0d911fea32858ab7_cgraph.svg" width="308" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aee0d81d2ae9aab7f0d911fea32858ab7_icgraph.svg" width="248" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad63ee2e58e4e87f600e8a35cb2b2a83e" name="ad63ee2e58e4e87f600e8a35cb2b2a83e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad63ee2e58e4e87f600e8a35cb2b2a83e">&#9670;&#160;</a></span>load_mnist_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_mnist_data </td>
          <td>(</td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>train_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>train_labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00144">144</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>{</div>
<div class="line"><span class="lineno">  146</span>    *train_images = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a> * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  147</span>    *train_labels = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a>);</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">if</span> (!*train_images || !*train_labels)</div>
<div class="line"><span class="lineno">  149</span>    {</div>
<div class="line"><span class="lineno">  150</span>        fprintf(stderr, <span class="stringliteral">&quot;Memory allocation failed for training data\n&quot;</span>);</div>
<div class="line"><span class="lineno">  151</span>        exit(1);</div>
<div class="line"><span class="lineno">  152</span>    }</div>
<div class="line"><span class="lineno">  153</span>    printf(<span class="stringliteral">&quot;Reading MNIST data...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_function" href="train_8c.html#a2a02b98e2929bb19d76a6dfbbac24d14">read_idx_file</a>(<span class="stringliteral">&quot;train-images-idx3-ubyte.gz&quot;</span>, *train_images, <a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a> * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_function" href="train_8c.html#a2a02b98e2929bb19d76a6dfbbac24d14">read_idx_file</a>(<span class="stringliteral">&quot;train-labels-idx1-ubyte.gz&quot;</span>, *train_labels, <a class="code hl_define" href="train_8c.html#aa46567f67c294dd7d88edfc29f4a287f">MNIST_TRAIN_SIZE</a>);</div>
<div class="line"><span class="lineno">  156</span>}</div>
<div class="ttc" id="atrain_8c_html_a2a02b98e2929bb19d76a6dfbbac24d14"><div class="ttname"><a href="train_8c.html#a2a02b98e2929bb19d76a6dfbbac24d14">read_idx_file</a></div><div class="ttdeci">void read_idx_file(const char *filename, unsigned char *data, int expected_size)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00287">train.c:287</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00041">MNIST_TRAIN_SIZE</a>, and <a class="el" href="train_8c_source.html#l00287">read_idx_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_ad63ee2e58e4e87f600e8a35cb2b2a83e_cgraph.svg" width="295" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_ad63ee2e58e4e87f600e8a35cb2b2a83e_icgraph.svg" width="244" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a840291bc02cba5474a4cb46a9b9566fe" name="a840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840291bc02cba5474a4cb46a9b9566fe">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00792">792</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  793</span>{</div>
<div class="line"><span class="lineno">  794</span>    srand(<a class="code hl_define" href="train_8c.html#a32ee58f73d9de0d1d41ad46f7bff2719">RAND_SEED</a>);</div>
<div class="line"><span class="lineno">  795</span>    <a class="code hl_struct" href="structNetwork.html">Network</a> net;</div>
<div class="line"><span class="lineno">  796</span>    <a class="code hl_function" href="train_8c.html#a045bb8b5750155f1b76ea8674ed46544">initialize_network</a>(&amp;net);</div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *train_images, *train_labels;</div>
<div class="line"><span class="lineno">  798</span>    <a class="code hl_function" href="train_8c.html#ad63ee2e58e4e87f600e8a35cb2b2a83e">load_mnist_data</a>(&amp;train_images, &amp;train_labels);</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *aug_images = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#a4ad142a4570cf177ac47f79fbf1680e2">TOTAL_SAMPLES</a> * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  800</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *aug_labels = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="train_8c.html#a4ad142a4570cf177ac47f79fbf1680e2">TOTAL_SAMPLES</a>);</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">if</span> (!aug_images || !aug_labels)</div>
<div class="line"><span class="lineno">  802</span>    {</div>
<div class="line"><span class="lineno">  803</span>        fprintf(stderr, <span class="stringliteral">&quot;Failed to allocate memory for augmented dataset\n&quot;</span>);</div>
<div class="line"><span class="lineno">  804</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  805</span>    }</div>
<div class="line"><span class="lineno">  806</span>    <a class="code hl_function" href="train_8c.html#a540654dda30c1be810556dd42ed6c145">create_augmented_dataset</a>(train_images, train_labels, aug_images, aug_labels);</div>
<div class="line"><span class="lineno">  807</span>    <a class="code hl_struct" href="structTrainingResources.html">TrainingResources</a> res;</div>
<div class="line"><span class="lineno">  808</span>    <a class="code hl_function" href="train_8c.html#aee0d81d2ae9aab7f0d911fea32858ab7">initialize_training_resources</a>(&amp;res);</div>
<div class="line"><span class="lineno">  809</span>    <a class="code hl_function" href="train_8c.html#aeb2041f1a971bb8b5197c9dfd38c81f2">train_network</a>(&amp;net, aug_images, aug_labels, <a class="code hl_define" href="train_8c.html#a4ad142a4570cf177ac47f79fbf1680e2">TOTAL_SAMPLES</a>, &amp;res);</div>
<div class="line"><span class="lineno">  810</span>    <a class="code hl_function" href="train_8c.html#a32ae2de2a05cfa448fe5f0032e439202">free_training_resources</a>(&amp;res);</div>
<div class="line"><span class="lineno">  811</span>    free(aug_images);</div>
<div class="line"><span class="lineno">  812</span>    free(aug_labels);</div>
<div class="line"><span class="lineno">  813</span>    free(train_images);</div>
<div class="line"><span class="lineno">  814</span>    free(train_labels);</div>
<div class="line"><span class="lineno">  815</span>    <a class="code hl_function" href="train_8c.html#a3fbfc99bdf0d9b7f756aa9ed4f1902a9">free_network</a>(&amp;net);</div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  817</span>}</div>
<div class="ttc" id="astructNetwork_html"><div class="ttname"><a href="structNetwork.html">Network</a></div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00063">train.c:64</a></div></div>
<div class="ttc" id="astructTrainingResources_html"><div class="ttname"><a href="structTrainingResources.html">TrainingResources</a></div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00075">train.c:76</a></div></div>
<div class="ttc" id="atrain_8c_html_a045bb8b5750155f1b76ea8674ed46544"><div class="ttname"><a href="train_8c.html#a045bb8b5750155f1b76ea8674ed46544">initialize_network</a></div><div class="ttdeci">void initialize_network(Network *net)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00252">train.c:252</a></div></div>
<div class="ttc" id="atrain_8c_html_a32ae2de2a05cfa448fe5f0032e439202"><div class="ttname"><a href="train_8c.html#a32ae2de2a05cfa448fe5f0032e439202">free_training_resources</a></div><div class="ttdeci">void free_training_resources(TrainingResources *res)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00130">train.c:130</a></div></div>
<div class="ttc" id="atrain_8c_html_a3fbfc99bdf0d9b7f756aa9ed4f1902a9"><div class="ttname"><a href="train_8c.html#a3fbfc99bdf0d9b7f756aa9ed4f1902a9">free_network</a></div><div class="ttdeci">void free_network(Network *net)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00240">train.c:240</a></div></div>
<div class="ttc" id="atrain_8c_html_a4ad142a4570cf177ac47f79fbf1680e2"><div class="ttname"><a href="train_8c.html#a4ad142a4570cf177ac47f79fbf1680e2">TOTAL_SAMPLES</a></div><div class="ttdeci">#define TOTAL_SAMPLES</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00061">train.c:61</a></div></div>
<div class="ttc" id="atrain_8c_html_a540654dda30c1be810556dd42ed6c145"><div class="ttname"><a href="train_8c.html#a540654dda30c1be810556dd42ed6c145">create_augmented_dataset</a></div><div class="ttdeci">void create_augmented_dataset(const unsigned char *train_images, const unsigned char *train_labels, unsigned char *augmented_images, unsigned char *augmented_labels)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00470">train.c:470</a></div></div>
<div class="ttc" id="atrain_8c_html_ad63ee2e58e4e87f600e8a35cb2b2a83e"><div class="ttname"><a href="train_8c.html#ad63ee2e58e4e87f600e8a35cb2b2a83e">load_mnist_data</a></div><div class="ttdeci">void load_mnist_data(unsigned char **train_images, unsigned char **train_labels)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00144">train.c:144</a></div></div>
<div class="ttc" id="atrain_8c_html_aeb2041f1a971bb8b5197c9dfd38c81f2"><div class="ttname"><a href="train_8c.html#aeb2041f1a971bb8b5197c9dfd38c81f2">train_network</a></div><div class="ttdeci">void train_network(Network *net, unsigned char *aug_images, unsigned char *aug_labels, int total_samples, TrainingResources *res)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00172">train.c:172</a></div></div>
<div class="ttc" id="atrain_8c_html_aee0d81d2ae9aab7f0d911fea32858ab7"><div class="ttname"><a href="train_8c.html#aee0d81d2ae9aab7f0d911fea32858ab7">initialize_training_resources</a></div><div class="ttdeci">void initialize_training_resources(TrainingResources *res)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00116">train.c:116</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00470">create_augmented_dataset()</a>, <a class="el" href="train_8c_source.html#l00240">free_network()</a>, <a class="el" href="train_8c_source.html#l00130">free_training_resources()</a>, <a class="el" href="train_8c_source.html#l00252">initialize_network()</a>, <a class="el" href="train_8c_source.html#l00116">initialize_training_resources()</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00144">load_mnist_data()</a>, <a class="el" href="train_8c_source.html#l00040">RAND_SEED</a>, <a class="el" href="train_8c_source.html#l00061">TOTAL_SAMPLES</a>, and <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="train_8c_a840291bc02cba5474a4cb46a9b9566fe_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="af45b379a1f8599ed7a63b03d911f5de2" name="af45b379a1f8599ed7a63b03d911f5de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af45b379a1f8599ed7a63b03d911f5de2">&#9670;&#160;</a></span>prepare_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prepare_batch </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>batch_X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>batch_y_onehot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00158">158</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  160</span>{</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  162</span>    {</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>; j++)</div>
<div class="line"><span class="lineno">  164</span>        {</div>
<div class="line"><span class="lineno">  165</span>            batch_X[i * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + j] = images[(start_idx + i) * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + j] / 255.0f;</div>
<div class="line"><span class="lineno">  166</span>        }</div>
<div class="line"><span class="lineno">  167</span>        memset(&amp;batch_y_onehot[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>], 0, <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  168</span>        batch_y_onehot[i * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a> + labels[start_idx + i]] = 1.0f;</div>
<div class="line"><span class="lineno">  169</span>    }</div>
<div class="line"><span class="lineno">  170</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, and <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_af45b379a1f8599ed7a63b03d911f5de2_icgraph.svg" width="388" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0867e81de2936adba1f10d470dd700a9" name="a0867e81de2936adba1f10d470dd700a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0867e81de2936adba1f10d470dd700a9">&#9670;&#160;</a></span>random_normal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float random_normal </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00280">280</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>{</div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordtype">float</span> u1 = (float)rand() / RAND_MAX;</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordtype">float</span> u2 = (float)rand() / RAND_MAX;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">return</span> sqrtf(-2.0f * logf(u1)) * cosf(2.0f * M_PI * u2);</div>
<div class="line"><span class="lineno">  285</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00252">initialize_network()</a>.</p>
<div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a0867e81de2936adba1f10d470dd700a9_icgraph.svg" width="426" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2a02b98e2929bb19d76a6dfbbac24d14" name="a2a02b98e2929bb19d76a6dfbbac24d14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a02b98e2929bb19d76a6dfbbac24d14">&#9670;&#160;</a></span>read_idx_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_idx_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>expected_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00287">287</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  288</span>{</div>
<div class="line"><span class="lineno">  289</span>    gzFile file = gzopen(filename, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">if</span> (!file)</div>
<div class="line"><span class="lineno">  291</span>    {</div>
<div class="line"><span class="lineno">  292</span>        fprintf(stderr, <span class="stringliteral">&quot;Error opening file: %s\n&quot;</span>, filename);</div>
<div class="line"><span class="lineno">  293</span>        exit(1);</div>
<div class="line"><span class="lineno">  294</span>    }</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> header[16];</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> (gzread(file, header, 4) != 4)</div>
<div class="line"><span class="lineno">  297</span>    {</div>
<div class="line"><span class="lineno">  298</span>        fprintf(stderr, <span class="stringliteral">&quot;Error reading magic number\n&quot;</span>);</div>
<div class="line"><span class="lineno">  299</span>        exit(1);</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordtype">int</span> magic = (header[0] &lt;&lt; 24) | (header[1] &lt;&lt; 16) | (header[2] &lt;&lt; 8) | header[3];</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordtype">int</span> dim_count = magic &amp; 0xff;</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordtype">int</span> total_size = 1;</div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dim_count; i++)</div>
<div class="line"><span class="lineno">  305</span>    {</div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordflow">if</span> (gzread(file, header + 4 * i, 4) != 4)</div>
<div class="line"><span class="lineno">  307</span>        {</div>
<div class="line"><span class="lineno">  308</span>            fprintf(stderr, <span class="stringliteral">&quot;Error reading dimensions\n&quot;</span>);</div>
<div class="line"><span class="lineno">  309</span>            exit(1);</div>
<div class="line"><span class="lineno">  310</span>        }</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordtype">int</span> dim = (header[4 * i] &lt;&lt; 24) | (header[4 * i + 1] &lt;&lt; 16) | (header[4 * i + 2] &lt;&lt; 8) | header[4 * i + 3];</div>
<div class="line"><span class="lineno">  312</span>        total_size *= dim;</div>
<div class="line"><span class="lineno">  313</span>    }</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> (total_size != expected_size)</div>
<div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  316</span>        fprintf(stderr, <span class="stringliteral">&quot;Unexpected file size\n&quot;</span>);</div>
<div class="line"><span class="lineno">  317</span>        exit(1);</div>
<div class="line"><span class="lineno">  318</span>    }</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">if</span> (gzread(file, data, total_size) != total_size)</div>
<div class="line"><span class="lineno">  320</span>    {</div>
<div class="line"><span class="lineno">  321</span>        fprintf(stderr, <span class="stringliteral">&quot;Error reading data\n&quot;</span>);</div>
<div class="line"><span class="lineno">  322</span>        exit(1);</div>
<div class="line"><span class="lineno">  323</span>    }</div>
<div class="line"><span class="lineno">  324</span>    gzclose(file);</div>
<div class="line"><span class="lineno">  325</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00144">load_mnist_data()</a>.</p>
<div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a2a02b98e2929bb19d76a6dfbbac24d14_icgraph.svg" width="398" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adb6293450780c47c93c102da587f72ff" name="adb6293450780c47c93c102da587f72ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6293450780c47c93c102da587f72ff">&#9670;&#160;</a></span>relu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float relu </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00512">512</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  513</span>{</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">return</span> (x &gt; 0) ? x : 0;</div>
<div class="line"><span class="lineno">  515</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00542">forward_pass()</a>.</p>
<div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_adb6293450780c47c93c102da587f72ff_icgraph.svg" width="478" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac5ac4bb5fc903348dece824ce5ddb25a" name="ac5ac4bb5fc903348dece824ce5ddb25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ac4bb5fc903348dece824ce5ddb25a">&#9670;&#160;</a></span>relu_derivative()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float relu_derivative </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00517">517</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  518</span>{</div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">return</span> (x &gt; 0) ? 1.0f : 0.0f;</div>
<div class="line"><span class="lineno">  520</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00608">backward_pass()</a>.</p>
<div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_ac5ac4bb5fc903348dece824ce5ddb25a_icgraph.svg" width="564" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a72fb9f512cf4afcefa5dce5e1608c9da" name="a72fb9f512cf4afcefa5dce5e1608c9da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72fb9f512cf4afcefa5dce5e1608c9da">&#9670;&#160;</a></span>rotate_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotate_image </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00395">395</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  396</span>{</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordtype">float</span> radian = angle * M_PI / 180.0f;</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordtype">float</span> cos_theta = cosf(radian);</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordtype">float</span> sin_theta = sinf(radian);</div>
<div class="line"><span class="lineno">  400</span>    memset(output, 0, <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>);</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; y++)</div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a>; x++)</div>
<div class="line"><span class="lineno">  404</span>        {</div>
<div class="line"><span class="lineno">  405</span>            <span class="keywordtype">float</span> xc = x - <a class="code hl_define" href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a>;</div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordtype">float</span> yc = y - <a class="code hl_define" href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a>;</div>
<div class="line"><span class="lineno">  407</span>            <span class="keywordtype">float</span> xr = xc * cos_theta - yc * sin_theta + <a class="code hl_define" href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a>;</div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordtype">float</span> yr = xc * sin_theta + yc * cos_theta + <a class="code hl_define" href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a>;</div>
<div class="line"><span class="lineno">  409</span>            <span class="keywordflow">if</span> (xr &gt;= 0 &amp;&amp; xr &lt; (<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> - 1) &amp;&amp; yr &gt;= 0 &amp;&amp; yr &lt; (<a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> - 1))</div>
<div class="line"><span class="lineno">  410</span>            {</div>
<div class="line"><span class="lineno">  411</span>                <span class="keywordtype">int</span> x0 = (int)xr;</div>
<div class="line"><span class="lineno">  412</span>                <span class="keywordtype">int</span> y0 = (int)yr;</div>
<div class="line"><span class="lineno">  413</span>                <span class="keywordtype">float</span> dx = xr - x0;</div>
<div class="line"><span class="lineno">  414</span>                <span class="keywordtype">float</span> dy = yr - y0;</div>
<div class="line"><span class="lineno">  415</span>                <span class="keywordtype">float</span> v00 = input[y0 * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + x0];</div>
<div class="line"><span class="lineno">  416</span>                <span class="keywordtype">float</span> v01 = input[y0 * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + (x0 + 1)];</div>
<div class="line"><span class="lineno">  417</span>                <span class="keywordtype">float</span> v10 = input[(y0 + 1) * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + x0];</div>
<div class="line"><span class="lineno">  418</span>                <span class="keywordtype">float</span> v11 = input[(y0 + 1) * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + (x0 + 1)];</div>
<div class="line"><span class="lineno">  419</span>                <span class="keywordtype">float</span> val = v00 * (1 - dx) * (1 - dy) + v01 * dx * (1 - dy) + v10 * (1 - dx) * dy + v11 * dx * dy;</div>
<div class="line"><span class="lineno">  420</span>                output[y * <a class="code hl_define" href="train_8c.html#aaf254aa4a9118e049fea4bcf80c08761">IMAGE_DIM</a> + x] = (<span class="keywordtype">unsigned</span> char)val;</div>
<div class="line"><span class="lineno">  421</span>            }</div>
<div class="line"><span class="lineno">  422</span>        }</div>
<div class="line"><span class="lineno">  423</span>    }</div>
<div class="line"><span class="lineno">  424</span>}</div>
<div class="ttc" id="atrain_8c_html_adc26a1aa65a6629bebea09a9744a05d4"><div class="ttname"><a href="train_8c.html#adc26a1aa65a6629bebea09a9744a05d4">IMAGE_CENTER</a></div><div class="ttdeci">#define IMAGE_CENTER</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00043">train.c:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00043">IMAGE_CENTER</a>, and <a class="el" href="train_8c_source.html#l00042">IMAGE_DIM</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00426">augment_digit()</a>.</p>
<div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a72fb9f512cf4afcefa5dce5e1608c9da_icgraph.svg" width="635" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a437746e641f2bd51b37181f853986a82" name="a437746e641f2bd51b37181f853986a82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437746e641f2bd51b37181f853986a82">&#9670;&#160;</a></span>save_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00743">743</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  744</span>{</div>
<div class="line"><span class="lineno">  745</span>    FILE *f = fopen(<span class="stringliteral">&quot;src/weights.h&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (!f)</div>
<div class="line"><span class="lineno">  747</span>    {</div>
<div class="line"><span class="lineno">  748</span>        fprintf(stderr, <span class="stringliteral">&quot;Error opening weights.h for writing\n&quot;</span>);</div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span>    fprintf(f, <span class="stringliteral">&quot;#ifndef WEIGHTS_H\n#define WEIGHTS_H\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  752</span>    fprintf(f, <span class="stringliteral">&quot;#define INPUT_SIZE %d\n&quot;</span>, <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  753</span>    fprintf(f, <span class="stringliteral">&quot;#define HIDDEN_SIZE %d\n&quot;</span>, <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>);</div>
<div class="line"><span class="lineno">  754</span>    fprintf(f, <span class="stringliteral">&quot;#define OUTPUT_SIZE %d\n\n&quot;</span>, <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>);</div>
<div class="line"><span class="lineno">  755</span>    fprintf(f, <span class="stringliteral">&quot;static const float HIDDEN_WEIGHTS[INPUT_SIZE * HIDDEN_SIZE] = {\n&quot;</span>);</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  757</span>    {</div>
<div class="line"><span class="lineno">  758</span>        fprintf(f, <span class="stringliteral">&quot;    %10.6ff%s&quot;</span>, net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a>[i], (i + 1 &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>) ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">if</span> ((i + 1) % 8 == 0)</div>
<div class="line"><span class="lineno">  760</span>            fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  761</span>    }</div>
<div class="line"><span class="lineno">  762</span>    fprintf(f, <span class="stringliteral">&quot;};\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  763</span>    fprintf(f, <span class="stringliteral">&quot;static const float HIDDEN_BIAS[HIDDEN_SIZE] = {\n&quot;</span>);</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  765</span>    {</div>
<div class="line"><span class="lineno">  766</span>        fprintf(f, <span class="stringliteral">&quot;    %10.6ff%s&quot;</span>, net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a>[i], (i + 1 &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>) ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  767</span>        <span class="keywordflow">if</span> ((i + 1) % 8 == 0)</div>
<div class="line"><span class="lineno">  768</span>            fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  769</span>    }</div>
<div class="line"><span class="lineno">  770</span>    fprintf(f, <span class="stringliteral">&quot;};\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  771</span>    fprintf(f, <span class="stringliteral">&quot;static const float OUTPUT_WEIGHTS[HIDDEN_SIZE * OUTPUT_SIZE] = {\n&quot;</span>);</div>
<div class="line"><span class="lineno">  772</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  773</span>    {</div>
<div class="line"><span class="lineno">  774</span>        fprintf(f, <span class="stringliteral">&quot;    %10.6ff%s&quot;</span>, net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>[i], (i + 1 &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>) ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">if</span> ((i + 1) % 8 == 0)</div>
<div class="line"><span class="lineno">  776</span>            fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  777</span>    }</div>
<div class="line"><span class="lineno">  778</span>    fprintf(f, <span class="stringliteral">&quot;};\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  779</span>    fprintf(f, <span class="stringliteral">&quot;static const float OUTPUT_BIAS[OUTPUT_SIZE] = {\n&quot;</span>);</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  781</span>    {</div>
<div class="line"><span class="lineno">  782</span>        fprintf(f, <span class="stringliteral">&quot;    %10.6ff%s&quot;</span>, net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a>[i], (i + 1 &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>) ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  783</span>        <span class="keywordflow">if</span> ((i + 1) % 8 == 0)</div>
<div class="line"><span class="lineno">  784</span>            fprintf(f, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  785</span>    }</div>
<div class="line"><span class="lineno">  786</span>    fprintf(f, <span class="stringliteral">&quot;};\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  787</span>    fprintf(f, <span class="stringliteral">&quot;#endif /* WEIGHTS_H */\n&quot;</span>);</div>
<div class="line"><span class="lineno">  788</span>    fclose(f);</div>
<div class="line"><span class="lineno">  789</span>    printf(<span class="stringliteral">&quot;Successfully saved weights to src/weights.h\n&quot;</span>);</div>
<div class="line"><span class="lineno">  790</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00066">Network::hidden_bias</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00065">Network::hidden_weights</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00068">Network::output_bias</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, and <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a437746e641f2bd51b37181f853986a82_icgraph.svg" width="384" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7a1e34018704a0309544d274d9af3520" name="a7a1e34018704a0309544d274d9af3520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1e34018704a0309544d274d9af3520">&#9670;&#160;</a></span>shuffle_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shuffle_data </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00327">327</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  328</span>{</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = n - 1; i &gt; 0; i--)</div>
<div class="line"><span class="lineno">  330</span>    {</div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordtype">int</span> j = rand() % (i + 1);</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a>; k++)</div>
<div class="line"><span class="lineno">  333</span>        {</div>
<div class="line"><span class="lineno">  334</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> temp = images[i * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + k];</div>
<div class="line"><span class="lineno">  335</span>            images[i * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + k] = images[j * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + k];</div>
<div class="line"><span class="lineno">  336</span>            images[j * <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> + k] = temp;</div>
<div class="line"><span class="lineno">  337</span>        }</div>
<div class="line"><span class="lineno">  338</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> temp = labels[i];</div>
<div class="line"><span class="lineno">  339</span>        labels[i] = labels[j];</div>
<div class="line"><span class="lineno">  340</span>        labels[j] = temp;</div>
<div class="line"><span class="lineno">  341</span>    }</div>
<div class="line"><span class="lineno">  342</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a7a1e34018704a0309544d274d9af3520_icgraph.svg" width="376" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ada4131daa6fd8cbfd794235c891e3250" name="ada4131daa6fd8cbfd794235c891e3250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada4131daa6fd8cbfd794235c891e3250">&#9670;&#160;</a></span>softmax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void softmax </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00522">522</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  523</span>{</div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordtype">float</span> max_val = input[0];</div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; size; i++)</div>
<div class="line"><span class="lineno">  526</span>    {</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">if</span> (input[i] &gt; max_val)</div>
<div class="line"><span class="lineno">  528</span>            max_val = input[i];</div>
<div class="line"><span class="lineno">  529</span>    }</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordtype">float</span> sum = 0.0f;</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)</div>
<div class="line"><span class="lineno">  532</span>    {</div>
<div class="line"><span class="lineno">  533</span>        output[i] = expf(input[i] - max_val);</div>
<div class="line"><span class="lineno">  534</span>        sum += output[i];</div>
<div class="line"><span class="lineno">  535</span>    }</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)</div>
<div class="line"><span class="lineno">  537</span>    {</div>
<div class="line"><span class="lineno">  538</span>        output[i] /= sum;</div>
<div class="line"><span class="lineno">  539</span>    }</div>
<div class="line"><span class="lineno">  540</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00542">forward_pass()</a>.</p>
<div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_ada4131daa6fd8cbfd794235c891e3250_icgraph.svg" width="506" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aeb2041f1a971bb8b5197c9dfd38c81f2" name="aeb2041f1a971bb8b5197c9dfd38c81f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb2041f1a971bb8b5197c9dfd38c81f2">&#9670;&#160;</a></span>train_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void train_network </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>aug_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>aug_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>total_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTrainingResources.html">TrainingResources</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00172">172</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  174</span>{</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordtype">int</span> num_batches = total_samples / <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordtype">float</span> best_accuracy = 0.0f;</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordtype">int</span> no_improve = 0;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    printf(<span class="stringliteral">&quot;Starting training...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> epoch = 0; epoch &lt; <a class="code hl_define" href="train_8c.html#ada2f6c75cc0154e34ea6a22ec4aeb665">NUM_EPOCHS</a>; epoch++)</div>
<div class="line"><span class="lineno">  181</span>    {</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordtype">float</span> learning_rate = <a class="code hl_define" href="train_8c.html#a422c752554c1822f2a959d1f0e21da45">BASE_LR</a> * powf(<a class="code hl_define" href="train_8c.html#ac71056dae36b9e620d0f517018e672d7">LR_DECAY</a>, epoch);</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordtype">float</span> epoch_loss = 0.0f;</div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordtype">float</span> epoch_acc = 0.0f;</div>
<div class="line"><span class="lineno">  185</span>        <a class="code hl_function" href="train_8c.html#a7a1e34018704a0309544d274d9af3520">shuffle_data</a>(aug_images, aug_labels, total_samples);</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> batch = 0; batch &lt; num_batches; batch++)</div>
<div class="line"><span class="lineno">  187</span>        {</div>
<div class="line"><span class="lineno">  188</span>            <span class="keywordtype">int</span> start_idx = batch * <a class="code hl_define" href="train_8c.html#a9ae2958e436c566413867028fc829ec0">BATCH_SIZE</a>;</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_function" href="train_8c.html#af45b379a1f8599ed7a63b03d911f5de2">prepare_batch</a>(aug_images, aug_labels, start_idx, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">batch_X</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">batch_y_onehot</a>);</div>
<div class="line"><span class="lineno">  190</span>            <a class="code hl_function" href="train_8c.html#af8ec7c8e288bad0b3243516a3b94ce82">forward_pass</a>(net, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">batch_X</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ad507211c96dd96735112ce263156598f">hidden_layer</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">output_layer</a>);</div>
<div class="line"><span class="lineno">  191</span>            <span class="keywordtype">float</span> batch_loss, batch_acc;</div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_function" href="train_8c.html#a2df9b11f3d149e3bb4d3410ca6808323">compute_loss_accuracy</a>(res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">output_layer</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">batch_y_onehot</a>, aug_labels, start_idx, &amp;batch_loss,</div>
<div class="line"><span class="lineno">  193</span>                                  &amp;batch_acc);</div>
<div class="line"><span class="lineno">  194</span>            epoch_loss += batch_loss;</div>
<div class="line"><span class="lineno">  195</span>            epoch_acc += batch_acc;</div>
<div class="line"><span class="lineno">  196</span>            <a class="code hl_function" href="train_8c.html#a062e67a2fff70756a17088d2582d8336">backward_pass</a>(net, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ae5f2baecab3da2a330a81e58240d1197">batch_X</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ad507211c96dd96735112ce263156598f">hidden_layer</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a1f8cbac853cda8f2da2c603252063a21">output_layer</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ab3d3425c79868eac1c2f85317957cdb1">batch_y_onehot</a>,</div>
<div class="line"><span class="lineno">  197</span>                          res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac23532e125a919f78d4649badc9ccaf0">hidden_error</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#acd7837e924805f9f5884c5691085f26a">output_error</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a06d35c239aaba97abcc22958fd167158">dw_hidden</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a748cd804c7b1a215005f47359c153a06">dw_output</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac36967338cce6cf90bce99a367eb2827">db_hidden</a>,</div>
<div class="line"><span class="lineno">  198</span>                          res-&gt;<a class="code hl_variable" href="structTrainingResources.html#aad9e00ff690e8fcbe8fb7ab33f4a95e7">db_output</a>);</div>
<div class="line"><span class="lineno">  199</span>            <a class="code hl_function" href="train_8c.html#a0c77fb0483f3a735de5fb2ef3d74a0ff">update_network</a>(net, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a06d35c239aaba97abcc22958fd167158">dw_hidden</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#a748cd804c7b1a215005f47359c153a06">dw_output</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#ac36967338cce6cf90bce99a367eb2827">db_hidden</a>, res-&gt;<a class="code hl_variable" href="structTrainingResources.html#aad9e00ff690e8fcbe8fb7ab33f4a95e7">db_output</a>, learning_rate);</div>
<div class="line"><span class="lineno">  200</span>            <span class="keywordflow">if</span> (batch % <a class="code hl_define" href="train_8c.html#a515cb544d69e291ad8d0cf6813c23f93">PRINT_INTERVAL</a> == 0)</div>
<div class="line"><span class="lineno">  201</span>            {</div>
<div class="line"><span class="lineno">  202</span>                printf(<span class="stringliteral">&quot;Batch %d/%d, Loss: %.4f, Accuracy: %.2f%%\n&quot;</span>, batch, num_batches, batch_loss,</div>
<div class="line"><span class="lineno">  203</span>                       batch_acc * 100.0f);</div>
<div class="line"><span class="lineno">  204</span>            }</div>
<div class="line"><span class="lineno">  205</span>        }</div>
<div class="line"><span class="lineno">  206</span>        epoch_loss /= num_batches;</div>
<div class="line"><span class="lineno">  207</span>        epoch_acc /= num_batches;</div>
<div class="line"><span class="lineno">  208</span>        printf(<span class="stringliteral">&quot;Epoch %d/%d, Loss: %.4f, Accuracy: %.2f%%\n&quot;</span>, epoch + 1, <a class="code hl_define" href="train_8c.html#ada2f6c75cc0154e34ea6a22ec4aeb665">NUM_EPOCHS</a>, epoch_loss, epoch_acc * 100.0f);</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">if</span> (epoch_acc &gt; best_accuracy)</div>
<div class="line"><span class="lineno">  210</span>        {</div>
<div class="line"><span class="lineno">  211</span>            best_accuracy = epoch_acc;</div>
<div class="line"><span class="lineno">  212</span>            no_improve = 0;</div>
<div class="line"><span class="lineno">  213</span>            printf(<span class="stringliteral">&quot;Saving best weights...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  214</span>            <a class="code hl_function" href="train_8c.html#a437746e641f2bd51b37181f853986a82">save_weights</a>(net);</div>
<div class="line"><span class="lineno">  215</span>        }</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  217</span>        {</div>
<div class="line"><span class="lineno">  218</span>            no_improve++;</div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">if</span> (no_improve &gt;= <a class="code hl_define" href="train_8c.html#af4fb82063ff79b16c303ea9bc3fc7bfa">PATIENCE</a>)</div>
<div class="line"><span class="lineno">  220</span>            {</div>
<div class="line"><span class="lineno">  221</span>                printf(<span class="stringliteral">&quot;Early stopping triggered. Best accuracy: %.2f%%\n&quot;</span>, best_accuracy * 100.0f);</div>
<div class="line"><span class="lineno">  222</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  223</span>            }</div>
<div class="line"><span class="lineno">  224</span>        }</div>
<div class="line"><span class="lineno">  225</span>    }</div>
<div class="line"><span class="lineno">  226</span>    printf(<span class="stringliteral">&quot;Training completed. Best accuracy: %.2f%%\n&quot;</span>, best_accuracy * 100.0f);</div>
<div class="line"><span class="lineno">  227</span>}</div>
<div class="ttc" id="atrain_8c_html_a062e67a2fff70756a17088d2582d8336"><div class="ttname"><a href="train_8c.html#a062e67a2fff70756a17088d2582d8336">backward_pass</a></div><div class="ttdeci">void backward_pass(const Network *net, const float *batch_X, const float *hidden_layer, const float *output_layer, const float *batch_y_onehot, float *hidden_error, float *output_error, float *dw_hidden, float *dw_output, float *db_hidden, float *db_output)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00608">train.c:608</a></div></div>
<div class="ttc" id="atrain_8c_html_a0c77fb0483f3a735de5fb2ef3d74a0ff"><div class="ttname"><a href="train_8c.html#a0c77fb0483f3a735de5fb2ef3d74a0ff">update_network</a></div><div class="ttdeci">void update_network(Network *net, const float *dw_hidden, const float *dw_output, const float *db_hidden, const float *db_output, float learning_rate)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00701">train.c:701</a></div></div>
<div class="ttc" id="atrain_8c_html_a2df9b11f3d149e3bb4d3410ca6808323"><div class="ttname"><a href="train_8c.html#a2df9b11f3d149e3bb4d3410ca6808323">compute_loss_accuracy</a></div><div class="ttdeci">void compute_loss_accuracy(const float *output_layer, const float *batch_y_onehot, const unsigned char *labels, int start_idx, float *batch_loss, float *batch_acc)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00575">train.c:575</a></div></div>
<div class="ttc" id="atrain_8c_html_a422c752554c1822f2a959d1f0e21da45"><div class="ttname"><a href="train_8c.html#a422c752554c1822f2a959d1f0e21da45">BASE_LR</a></div><div class="ttdeci">#define BASE_LR</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00051">train.c:51</a></div></div>
<div class="ttc" id="atrain_8c_html_a437746e641f2bd51b37181f853986a82"><div class="ttname"><a href="train_8c.html#a437746e641f2bd51b37181f853986a82">save_weights</a></div><div class="ttdeci">void save_weights(Network *net)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00743">train.c:743</a></div></div>
<div class="ttc" id="atrain_8c_html_a515cb544d69e291ad8d0cf6813c23f93"><div class="ttname"><a href="train_8c.html#a515cb544d69e291ad8d0cf6813c23f93">PRINT_INTERVAL</a></div><div class="ttdeci">#define PRINT_INTERVAL</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00049">train.c:49</a></div></div>
<div class="ttc" id="atrain_8c_html_a7a1e34018704a0309544d274d9af3520"><div class="ttname"><a href="train_8c.html#a7a1e34018704a0309544d274d9af3520">shuffle_data</a></div><div class="ttdeci">void shuffle_data(unsigned char *images, unsigned char *labels, int n)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00327">train.c:327</a></div></div>
<div class="ttc" id="atrain_8c_html_ac71056dae36b9e620d0f517018e672d7"><div class="ttname"><a href="train_8c.html#ac71056dae36b9e620d0f517018e672d7">LR_DECAY</a></div><div class="ttdeci">#define LR_DECAY</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00052">train.c:52</a></div></div>
<div class="ttc" id="atrain_8c_html_ada2f6c75cc0154e34ea6a22ec4aeb665"><div class="ttname"><a href="train_8c.html#ada2f6c75cc0154e34ea6a22ec4aeb665">NUM_EPOCHS</a></div><div class="ttdeci">#define NUM_EPOCHS</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00059">train.c:59</a></div></div>
<div class="ttc" id="atrain_8c_html_af45b379a1f8599ed7a63b03d911f5de2"><div class="ttname"><a href="train_8c.html#af45b379a1f8599ed7a63b03d911f5de2">prepare_batch</a></div><div class="ttdeci">void prepare_batch(const unsigned char *images, const unsigned char *labels, int start_idx, float *batch_X, float *batch_y_onehot)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00158">train.c:158</a></div></div>
<div class="ttc" id="atrain_8c_html_af4fb82063ff79b16c303ea9bc3fc7bfa"><div class="ttname"><a href="train_8c.html#af4fb82063ff79b16c303ea9bc3fc7bfa">PATIENCE</a></div><div class="ttdeci">#define PATIENCE</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00050">train.c:50</a></div></div>
<div class="ttc" id="atrain_8c_html_af8ec7c8e288bad0b3243516a3b94ce82"><div class="ttname"><a href="train_8c.html#af8ec7c8e288bad0b3243516a3b94ce82">forward_pass</a></div><div class="ttdeci">void forward_pass(const Network *net, const float *batch_X, float *hidden_layer, float *output_layer)</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00542">train.c:542</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00608">backward_pass()</a>, <a class="el" href="train_8c_source.html#l00051">BASE_LR</a>, <a class="el" href="train_8c_source.html#l00058">BATCH_SIZE</a>, <a class="el" href="train_8c_source.html#l00077">TrainingResources::batch_X</a>, <a class="el" href="train_8c_source.html#l00078">TrainingResources::batch_y_onehot</a>, <a class="el" href="train_8c_source.html#l00575">compute_loss_accuracy()</a>, <a class="el" href="train_8c_source.html#l00085">TrainingResources::db_hidden</a>, <a class="el" href="train_8c_source.html#l00086">TrainingResources::db_output</a>, <a class="el" href="train_8c_source.html#l00083">TrainingResources::dw_hidden</a>, <a class="el" href="train_8c_source.html#l00084">TrainingResources::dw_output</a>, <a class="el" href="train_8c_source.html#l00542">forward_pass()</a>, <a class="el" href="train_8c_source.html#l00081">TrainingResources::hidden_error</a>, <a class="el" href="train_8c_source.html#l00079">TrainingResources::hidden_layer</a>, <a class="el" href="train_8c_source.html#l00052">LR_DECAY</a>, <a class="el" href="train_8c_source.html#l00059">NUM_EPOCHS</a>, <a class="el" href="train_8c_source.html#l00082">TrainingResources::output_error</a>, <a class="el" href="train_8c_source.html#l00080">TrainingResources::output_layer</a>, <a class="el" href="train_8c_source.html#l00050">PATIENCE</a>, <a class="el" href="train_8c_source.html#l00158">prepare_batch()</a>, <a class="el" href="train_8c_source.html#l00049">PRINT_INTERVAL</a>, <a class="el" href="train_8c_source.html#l00743">save_weights()</a>, <a class="el" href="train_8c_source.html#l00327">shuffle_data()</a>, and <a class="el" href="train_8c_source.html#l00701">update_network()</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00792">main()</a>.</p>
<div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aeb2041f1a971bb8b5197c9dfd38c81f2_cgraph.svg" width="516" height="332"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_aeb2041f1a971bb8b5197c9dfd38c81f2_icgraph.svg" width="226" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0c77fb0483f3a735de5fb2ef3d74a0ff" name="a0c77fb0483f3a735de5fb2ef3d74a0ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c77fb0483f3a735de5fb2ef3d74a0ff">&#9670;&#160;</a></span>update_network()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_network </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNetwork.html">Network</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>dw_hidden</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>dw_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>db_hidden</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>db_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>learning_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="train_8c_source.html#l00701">701</a> of file <a class="el" href="train_8c_source.html">train.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  703</span>{</div>
<div class="line"><span class="lineno">  704</span><span class="preprocessor">#pragma omp parallel sections</span></div>
<div class="line"><span class="lineno">  705</span>    {</div>
<div class="line"><span class="lineno">  706</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  707</span>        {</div>
<div class="line"><span class="lineno">  708</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#abcf72cd23bdafb47b19023d91b4c107d">INPUT_SIZE</a> * <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  709</span>            {</div>
<div class="line"><span class="lineno">  710</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a>[i] =</div>
<div class="line"><span class="lineno">  711</span>                    <a class="code hl_define" href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a> * net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a>[i] - learning_rate * dw_hidden[i];</div>
<div class="line"><span class="lineno">  712</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a8cc052279886c1b01d6a0a1d047a0066">hidden_weights</a>[i] += net-&gt;<a class="code hl_variable" href="structNetwork.html#a9921a0ae2aaa34ebf1090d49a9d64528">hidden_weights_momentum</a>[i];</div>
<div class="line"><span class="lineno">  713</span>            }</div>
<div class="line"><span class="lineno">  714</span>        }</div>
<div class="line"><span class="lineno">  715</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  716</span>        {</div>
<div class="line"><span class="lineno">  717</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  718</span>            {</div>
<div class="line"><span class="lineno">  719</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a>[i] = <a class="code hl_define" href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a> * net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a>[i] - learning_rate * db_hidden[i];</div>
<div class="line"><span class="lineno">  720</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#aadc84bfd2c6e86ca02cee9a9b2b18fe1">hidden_bias</a>[i] += net-&gt;<a class="code hl_variable" href="structNetwork.html#ad06f80979b0f6fdbf8ee3b9e184f074c">hidden_bias_momentum</a>[i];</div>
<div class="line"><span class="lineno">  721</span>            }</div>
<div class="line"><span class="lineno">  722</span>        }</div>
<div class="line"><span class="lineno">  723</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  724</span>        {</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a25246c9bd0d5ab0de866124c7fb55128">HIDDEN_SIZE</a> * <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  726</span>            {</div>
<div class="line"><span class="lineno">  727</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a>[i] =</div>
<div class="line"><span class="lineno">  728</span>                    <a class="code hl_define" href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a> * net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a>[i] - learning_rate * dw_output[i];</div>
<div class="line"><span class="lineno">  729</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a7e455612362df041b021562ce934fe19">output_weights</a>[i] += net-&gt;<a class="code hl_variable" href="structNetwork.html#a891f2791f142f8652bac3d5f9ea7399c">output_weights_momentum</a>[i];</div>
<div class="line"><span class="lineno">  730</span>            }</div>
<div class="line"><span class="lineno">  731</span>        }</div>
<div class="line"><span class="lineno">  732</span><span class="preprocessor">#pragma omp section</span></div>
<div class="line"><span class="lineno">  733</span>        {</div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_define" href="train_8c.html#a894874fce4252e840e2412fd1dbfa4ea">OUTPUT_SIZE</a>; i++)</div>
<div class="line"><span class="lineno">  735</span>            {</div>
<div class="line"><span class="lineno">  736</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a>[i] = <a class="code hl_define" href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a> * net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a>[i] - learning_rate * db_output[i];</div>
<div class="line"><span class="lineno">  737</span>                net-&gt;<a class="code hl_variable" href="structNetwork.html#a0eb4e771d57fa76646d94505d23b69c2">output_bias</a>[i] += net-&gt;<a class="code hl_variable" href="structNetwork.html#a2224b842e1ac4f20ee957c9a36604c06">output_bias_momentum</a>[i];</div>
<div class="line"><span class="lineno">  738</span>            }</div>
<div class="line"><span class="lineno">  739</span>        }</div>
<div class="line"><span class="lineno">  740</span>    }</div>
<div class="line"><span class="lineno">  741</span>}</div>
<div class="ttc" id="atrain_8c_html_ab86cb6f507edc7b439a6fb895ab14cc1"><div class="ttname"><a href="train_8c.html#ab86cb6f507edc7b439a6fb895ab14cc1">MOMENTUM</a></div><div class="ttdeci">#define MOMENTUM</div><div class="ttdef"><b>Definition</b> <a href="train_8c_source.html#l00053">train.c:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="train_8c_source.html#l00066">Network::hidden_bias</a>, <a class="el" href="train_8c_source.html#l00070">Network::hidden_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00056">HIDDEN_SIZE</a>, <a class="el" href="train_8c_source.html#l00065">Network::hidden_weights</a>, <a class="el" href="train_8c_source.html#l00069">Network::hidden_weights_momentum</a>, <a class="el" href="train_8c_source.html#l00055">INPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00053">MOMENTUM</a>, <a class="el" href="train_8c_source.html#l00068">Network::output_bias</a>, <a class="el" href="train_8c_source.html#l00072">Network::output_bias_momentum</a>, <a class="el" href="train_8c_source.html#l00057">OUTPUT_SIZE</a>, <a class="el" href="train_8c_source.html#l00067">Network::output_weights</a>, and <a class="el" href="train_8c_source.html#l00071">Network::output_weights_momentum</a>.</p>

<p class="reference">Referenced by <a class="el" href="train_8c_source.html#l00172">train_network()</a>.</p>
<div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="train_8c_a0c77fb0483f3a735de5fb2ef3d74a0ff_icgraph.svg" width="400" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="train_8c.html">train.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
